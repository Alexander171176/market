import{u as L,m as x,o as v,f as e,t as n,k as a,l as g,C as B,i as m,w as $,F as G,v as Q,D as q,y as W,E as w,G as R,e as z,n as D,p as V}from"./vendor-gheHEdqg.js";import{A as X}from"./AdminLayout-BORZmYLa.js";import{T as Y}from"./TitlePage-Fnu_rZTs.js";import{_ as O,a as ee,b as te}from"./CountTable-B8E6LLQi.js";import{_ as se,a as oe,b as le}from"./SearchInput-CxszY3SV.js";import{_ as ae}from"./ActivityToggle-D_HDh_Cp.js";import{_ as re}from"./IconEdit-DU30ww26.js";import{_ as ie}from"./CloneIconButton-DCZyrBhT.js";import{_ as ne}from"./BulkActionSelect-CoOvDtmT.js";import{_ as ce}from"./DefaultButton-FyNer1Yu.js";import{a as de}from"./vendor-axios-jn5v1YEJ.js";import"./vendor-lodash-DlPAqqwV.js";import"./sidebarIcons-4a0tifbk.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ResponsiveNavLink-rBqbn9MM.js";import"./ScrollButtons-Cu_QW-CT.js";import"./app-CAaXoGpY.js";import"./auth-image-XbvYdkSi.js";const ue={class:"flex justify-center items-center h-fit sm:mr-4 mt-2 mb-2"},pe={for:"sortParam",class:"hidden lg:block sm:mr-2 tracking-wider text-sm font-semibold text-slate-600 dark:text-slate-100"},ve=["value"],he={value:"idDesc"},me={value:"idAsc"},_e={value:"sort"},fe={value:"title"},ge={value:"locale"},xe={value:"views"},ye={value:"activity"},we={value:"inactive"},be={__name:"SortSelect",props:{sortParam:String},emits:["update:sortParam"],setup(h,{emit:f}){const{t:l}=L(),b=f,u=i=>{b("update:sortParam",i.target.value)};return(i,S)=>(v(),x("div",ue,[e("label",pe,n(a(l)("sort")),1),e("select",{id:"sortParam",value:h.sortParam,onChange:u,class:"w-36 px-3 py-0.5 form-select bg-white dark:bg-gray-200 text-gray-600 dark:text-gray-900 border border-slate-400 dark:border-slate-600 rounded-sm shadow-sm"},[e("option",he,n(a(l)("idDesc")),1),e("option",me,n(a(l)("idAsc")),1),e("option",_e,n(a(l)("sortNumber")),1),e("option",fe,n(a(l)("title")),1),e("option",ge,n(a(l)("localization")),1),e("option",xe,n(a(l)("views")),1),e("option",ye,n(a(l)("active")),1),e("option",we,n(a(l)("inactive")),1)],40,ve)]))}},ke={class:"bg-white dark:bg-slate-700 shadow-lg rounded-sm border border-slate-200 dark:border-slate-600 relative"},$e={class:"overflow-x-auto"},Se={key:0,class:"table-auto w-full text-slate-700 dark:text-slate-100"},Ce={class:"text-sm uppercase bg-slate-200 dark:bg-cyan-900 border border-solid border-gray-300 dark:border-gray-700"},Ae=e("th",{class:"px-2 py-3 w-px"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4 fill-current text-slate-800 dark:text-slate-200",height:"24",width:"24",viewBox:"0 0 24 24"},[e("path",{d:"M12.707,2.293a1,1,0,0,0-1.414,0l-5,5A1,1,0,0,0,7.707,8.707L12,4.414l4.293,4.293a1,1,0,0,0,1.414-1.414Z"}),e("path",{d:"M16.293,15.293,12,19.586,7.707,15.293a1,1,0,0,0-1.414,1.414l5,5a1,1,0,0,0,1.414,0l5-5a1,1,0,0,0-1.414-1.414Z"})])],-1),ze={class:"px-2 first:pl-7 last:pr-7 py-3 whitespace-nowrap w-px"},De={class:"text-center font-medium"},Te={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap w-px"},Me=["title"],Pe=e("svg",{class:"w-6 h-6 fill-current shrink-0",viewBox:"0 0 512 512"},[e("path",{d:"M0 96C0 60.7 28.7 32 64 32l384 0c35.3 0 64 28.7 64 64l0 320c0 35.3-28.7 64-64 64L64 480c-35.3 0-64-28.7-64-64L0 96zM323.8 202.5c-4.5-6.6-11.9-10.5-19.8-10.5s-15.4 3.9-19.8 10.5l-87 127.6L170.7 297c-4.6-5.7-11.5-9-18.7-9s-14.2 3.3-18.7 9l-64 80c-5.8 7.2-6.9 17.1-2.9 25.4s12.4 13.6 21.6 13.6l96 0 32 0 208 0c8.9 0 17.1-4.9 21.2-12.8s3.6-17.4-1.4-24.7l-120-176zM112 192a48 48 0 1 0 0-96 48 48 0 1 0 0 96z"})],-1),Re=[Pe],Ve={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap w-px"},Be=["title"],Le=e("svg",{class:"w-8 h-8 fill-current shrink-0",viewBox:"0 0 640 512"},[e("path",{d:"M0 128C0 92.7 28.7 64 64 64l192 0 48 0 16 0 256 0c35.3 0 64 28.7 64 64l0 256c0 35.3-28.7 64-64 64l-256 0-16 0-48 0L64 448c-35.3 0-64-28.7-64-64L0 128zm320 0l0 256 256 0 0-256-256 0zM178.3 175.9c-3.2-7.2-10.4-11.9-18.3-11.9s-15.1 4.7-18.3 11.9l-64 144c-4.5 10.1 .1 21.9 10.2 26.4s21.9-.1 26.4-10.2l8.9-20.1 73.6 0 8.9 20.1c4.5 10.1 16.3 14.6 26.4 10.2s14.6-16.3 10.2-26.4l-64-144zM160 233.2L179 276l-38 0 19-42.8zM448 164c11 0 20 9 20 20l0 4 44 0 16 0c11 0 20 9 20 20s-9 20-20 20l-2 0-1.6 4.5c-8.9 24.4-22.4 46.6-39.6 65.4c.9 .6 1.8 1.1 2.7 1.6l18.9 11.3c9.5 5.7 12.5 18 6.9 27.4s-18 12.5-27.4 6.9l-18.9-11.3c-4.5-2.7-8.8-5.5-13.1-8.5c-10.6 7.5-21.9 14-34 19.4l-3.6 1.6c-10.1 4.5-21.9-.1-26.4-10.2s.1-21.9 10.2-26.4l3.6-1.6c6.4-2.9 12.6-6.1 18.5-9.8l-12.2-12.2c-7.8-7.8-7.8-20.5 0-28.3s20.5-7.8 28.3 0l14.6 14.6 .5 .5c12.4-13.1 22.5-28.3 29.8-45L448 228l-72 0c-11 0-20-9-20-20s9-20 20-20l52 0 0-4c0-11 9-20 20-20z"})],-1),Ee=[Le],Ie={class:"px-2 first:pl-7 last:pr-7 py-3 whitespace-nowrap"},Ue={class:"text-left font-medium"},He={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},Ne={class:"font-medium text-left"},Fe={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap w-px"},Ke=["title"],je=e("svg",{class:"w-4 h-4 fill-current shrink-0",viewBox:"0 0 16 16"},[e("path",{d:"M8 2C3.246 2 .251 7.29.127 7.515a.998.998 0 0 0 .002.975c.07.125 1.044 1.801 2.695 3.274C4.738 13.582 6.283 14 8 14c4.706 0 7.743-5.284 7.872-5.507a1 1 0 0 0 0-.98A13.292 13.292 0 0 0 8 2zm0 10a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm0-6a2 2 0 1 0 0 4 2 2 0 0 0 0-4z"})],-1),Je=[je],Ze={class:"px-2 first:pl-7 last:pr-7 py-3 whitespace-nowrap"},Ge={class:"text-center font-medium"},Qe={class:"px-2 first:pl-7 last:pr-7 py-3 whitespace-nowrap"},qe={class:"text-center font-medium"},We={class:"text-sm font-semibold border-b-2 hover:bg-slate-100 dark:hover:bg-cyan-800"},Xe=e("td",{class:"px-2 py-1 text-center cursor-move handle"},[e("svg",{class:"w-4 h-4 text-gray-500 dark:text-gray-300",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M7 4h2v2H7V4zm4 0h2v2h-2V4zM7 8h2v2H7V8zm4 0h2v2h-2V8zM7 12h2v2H7v-2zm4 0h2v2h-2v-2z"})])],-1),Ye={class:"px-2 first:pl-7 last:pr-7 py-1 whitespace-nowrap"},Oe={class:"text-center text-blue-600 dark:text-blue-200"},et={class:"px-2 first:pl-7 last:pr-7 py-1 whitespace-nowrap w-10"},tt=["innerHTML"],st={key:1,class:"flex justify-center items-center h-full text-slate-400"},ot=e("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 16 16"},[e("path",{d:"M8 8a3 3 0 100-6 3 3 0 000 6zm2-3a2 2 0 11-4 0 2 2 0 014 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"})],-1),lt=[ot],at={class:"px-2 first:pl-7 last:pr-7 py-1 whitespace-nowrap w-10"},rt={class:"text-center uppercase text-orange-500 dark:text-orange-200"},it={class:"px-2 first:pl-7 last:pr-7 py-1 whitespace-nowrap"},nt={class:"text-left"},ct=["href"],dt={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},ut={class:"text-left"},pt=["title"],vt={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},ht={class:"text-center"},mt={class:"px-2 first:pl-7 last:pr-7 py-1 whitespace-nowrap"},_t={class:"flex justify-center space-x-2"},ft={class:"px-2 first:pl-7 last:pr-7 py-1 whitespace-nowrap"},gt={class:"text-center"},xt=["checked","onChange"],yt={key:1,class:"p-5 text-center text-slate-700 dark:text-slate-100"},wt={__name:"RubricTable",props:{rubrics:Array,selectedRubrics:Array},emits:["toggle-activity","edit","delete","update-sort-order","clone","toggle-select","toggle-all"],setup(h,{emit:f}){const{t:l}=L(),b=h,u=f,i=g([]);B(()=>b.rubrics,d=>{i.value=JSON.parse(JSON.stringify(d||[]))},{immediate:!0,deep:!0});const S=()=>{const d=i.value.map(y=>y.id);u("update-sort-order",d)},k=d=>{const y=d.target.checked,r=i.value.map(_=>_.id);u("toggle-all",{ids:r,checked:y})};return(d,y)=>(v(),x("div",ke,[e("div",$e,[h.rubrics.length>0?(v(),x("table",Se,[e("thead",Ce,[e("tr",null,[Ae,e("th",ze,[e("div",De,n(a(l)("id")),1)]),e("th",Te,[e("div",{class:"flex justify-center",title:a(l)("icon")},Re,8,Me)]),e("th",Ve,[e("div",{class:"flex justify-center",title:a(l)("localization")},Ee,8,Be)]),e("th",Ie,[e("div",Ue,n(a(l)("title")),1)]),e("th",He,[e("div",Ne,n(a(l)("sections")),1)]),e("th",Fe,[e("div",{class:"flex justify-center",title:a(l)("views")},Je,8,Ke)]),e("th",Ze,[e("div",Ge,n(a(l)("actions")),1)]),e("th",Qe,[e("div",qe,[e("input",{type:"checkbox",onChange:k},null,32)])])])]),m(a(q),{tag:"tbody",modelValue:i.value,"onUpdate:modelValue":y[0]||(y[0]=r=>i.value=r),onEnd:S,itemKey:"id",handle:".handle"},{item:$(({element:r})=>[e("tr",We,[Xe,e("td",Ye,[e("div",Oe,n(r.id),1)]),e("td",et,[r.icon?(v(),x("div",{key:0,class:"flex justify-center items-center h-full",innerHTML:r.icon},null,8,tt)):(v(),x("div",st,lt))]),e("td",at,[e("div",rt,n(r.locale),1)]),e("td",it,[e("div",nt,[e("a",{href:`/rubrics/${encodeURIComponent(r.url)}`,class:"text-violet-600 dark:text-violet-200 hover:underline hover:text-violet-800 dark:hover:text-violet-50",target:"_blank",rel:"noopener noreferrer"},n(r.title),9,ct)])]),e("td",dt,[e("div",ut,[(v(!0),x(G,null,Q(r.sections,_=>(v(),x("span",{key:_.id},[e("span",{title:_.title,class:"py-0.5 px-1.5 mr-0.5 badge bg-blue-500 dark:bg-blue-200 rounded-sm text-xs text-slate-100 dark:text-slate-900"},n(_.id),9,pt)]))),128))])]),e("td",vt,[e("div",ht,n(r.views),1)]),e("td",mt,[e("div",_t,[m(ae,{isActive:r.activity,onToggleActivity:_=>d.$emit("toggle-activity",r),title:r.activity?a(l)("enabled"):a(l)("disabled")},null,8,["isActive","onToggleActivity","title"]),m(ie,{onClone:_=>d.$emit("clone",r)},null,8,["onClone"]),m(re,{href:d.route("admin.rubrics.edit",r.id)},null,8,["href"]),m(O,{onDelete:_=>d.$emit("delete",r.id)},null,8,["onDelete"])])]),e("td",ft,[e("div",gt,[e("input",{type:"checkbox",checked:h.selectedRubrics.includes(r.id),onChange:_=>d.$emit("toggle-select",r.id)},null,40,xt)])])])]),_:1},8,["modelValue"])])):(v(),x("div",yt,n(a(l)("noData")),1))])]))}},bt={class:"px-4 sm:px-6 lg:px-8 py-8 w-full max-w-12xl mx-auto"},kt={class:"p-4 bg-slate-50 dark:bg-slate-700 border border-blue-400 dark:border-blue-200 overflow-hidden shadow-lg shadow-gray-500 dark:shadow-slate-400 bg-opacity-95 dark:bg-opacity-95"},$t={class:"sm:flex sm:justify-between sm:items-center mb-2"},St=e("svg",{class:"w-4 h-4 fill-current opacity-50 shrink-0",viewBox:"0 0 16 16"},[e("path",{d:"M15 7H9V1c0-.6-.4-1-1-1S7 .4 7 1v6H1c-.6 0-1 .4-1 1s.4 1 1 1h6v6c0 .6.4 1 1 1s1-.4 1-1V9h6c.6 0 1-.4 1-1s-.4-1-1-1z"})],-1),Ct={key:2,class:"flex justify-between items-center flex-col md:flex-row my-1"},Jt={__name:"Index",props:["rubrics","rubricsCount","adminCountRubrics","adminSortRubrics"],setup(h){const{t:f}=L(),l=W(),b=h,u=g(b.adminCountRubrics);B(u,s=>{w.put(route("admin.settings.updateAdminCountRubrics"),{value:s},{preserveScroll:!0,preserveState:!0,onSuccess:()=>l.info(`Показ ${s} элементов на странице.`),onError:t=>l.error(t.value||"Ошибка обновления кол-ва элементов.")})});const i=g(b.adminSortRubrics);B(i,s=>{w.put(route("admin.settings.updateAdminSortRubrics"),{value:s},{preserveScroll:!0,preserveState:!0,onSuccess:()=>l.info("Сортировка успешно изменена"),onError:t=>l.error(t.value||"Ошибка обновления сортировки.")})});const S=g(!1),k=g(null),d=g(""),y=(s,t)=>{k.value=s,d.value=t,S.value=!0},r=()=>{S.value=!1,k.value=null,d.value=""},_=()=>{if(k.value===null)return;const s=k.value,t=d.value;w.delete(route("admin.rubrics.destroy",{rubric:s}),{preserveScroll:!0,preserveState:!1,onSuccess:o=>{r(),l.success(`Рубрика "${t||"ID: "+s}" удалена.`)},onError:o=>{r();const p=o.general||o[Object.keys(o)[0]]||"Произошла ошибка при удалении.";l.error(`${p} (Рубрика: ${t||"ID: "+s})`),console.error("Ошибка удаления:",o)},onFinish:()=>{k.value=null,d.value=""}})},I=s=>{const t=!s.activity,o=t?"активирована":"деактивирована";w.put(route("admin.actions.rubrics.updateActivity",{rubric:s.id}),{activity:t},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{l.success(`Рубрика "${s.title}" ${o}.`)},onError:p=>{l.error(p.activity||p.general||`Ошибка изменения активности для "${s.title}".`)}})},U=s=>{const t=s==null?void 0:s.id,o=(s==null?void 0:s.title)||`ID: ${t}`;if(typeof t>"u"||t===null){console.error("Не удалось получить ID рубрики для клонирования",s),l.error("Не удалось определить рубрику для клонирования.");return}confirm(`Вы уверены, что хотите клонировать рубрику "${o}"?`)&&w.post(route("admin.actions.rubrics.clone",{rubric:t}),{},{preserveScroll:!0,preserveState:!1,onSuccess:p=>{l.success(`Рубрика "${o}" успешно клонирована.`)},onError:p=>{const P=Object.keys(p)[0],Z=p[P]||`Ошибка клонирования рубрики "${o}".`;l.error(Z)}})},C=g(1),A=g(""),H=s=>i.value==="idAsc"?s.slice().sort((t,o)=>t.id-o.id):i.value==="idDesc"?s.slice().sort((t,o)=>o.id-t.id):i.value==="activity"?s.filter(t=>t.activity):i.value==="inactive"?s.filter(t=>!t.activity):i.value==="locale"?s.slice().sort((t,o)=>t.locale<o.locale?1:t.locale>o.locale?-1:0):i.value==="views"?s.slice().sort((t,o)=>o[i.value]-t[i.value]):s.slice().sort((t,o)=>t[i.value]<o[i.value]?-1:t[i.value]>o[i.value]?1:0),T=R(()=>{let s=b.rubrics;return A.value&&(s=s.filter(t=>t.title.toLowerCase().includes(A.value.toLowerCase()))),H(s)}),M=R(()=>{const s=(C.value-1)*u.value;return T.value.slice(s,s+u.value)});R(()=>Math.ceil(T.value.length/u.value));const N=s=>{const t=(C.value-1)*u.value,o=s.map((p,P)=>({id:p,sort:t+P+1}));w.put(route("admin.actions.rubrics.updateSortBulk"),{rubrics:o},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{l.success("Порядок рубрик успешно обновлен.")},onError:p=>{console.error("Ошибка обновления сортировки:",p),l.error(p.general||p.rubrics||"Не удалось обновить порядок рубрик."),w.reload({only:["rubrics"],preserveScroll:!0})}})},c=g([]),F=({ids:s,checked:t})=>{t?c.value=[...new Set([...c.value,...s])]:c.value=c.value.filter(o=>!s.includes(o))},K=s=>{const t=c.value.indexOf(s);t>-1?c.value.splice(t,1):c.value.push(s)},E=s=>{if(!c.value.length){l.warning("Выберите рубрики для активации/деактивации рубрик");return}de.put(route("admin.actions.rubrics.bulkUpdateActivity"),{ids:c.value,activity:s}).then(()=>{l.success("Активность массово обновлена");const t=[...c.value];c.value=[],M.value.forEach(o=>{t.includes(o.id)&&(o.activity=s)})}).catch(()=>{l.error("Не удалось обновить активность")})},j=()=>{if(c.value.length===0){l.warning("Выберите хотя бы одну рубрику для удаления.");return}confirm("Вы уверены, что хотите их удалить ?")&&w.delete(route("admin.actions.rubrics.bulkDestroy"),{data:{ids:c.value},preserveScroll:!0,preserveState:!1,onSuccess:s=>{c.value=[],l.success("Массовое удаление рубрик успешно завершено.")},onError:s=>{console.error("Ошибка массового удаления:",s);const t=Object.keys(s)[0],o=s[t]||"Произошла ошибка при удалении рубрик.";l.error(o)}})},J=s=>{const t=s.target.value;t==="selectAll"?c.value=M.value.map(o=>o.id):t==="deselectAll"?c.value=[]:t==="activate"?E(!0):t==="deactivate"?E(!1):t==="delete"&&j(),s.target.value=""};return(s,t)=>(v(),z(X,{title:a(f)("rubrics")},{header:$(()=>[m(Y,null,{default:$(()=>[V(n(a(f)("rubrics")),1)]),_:1})]),default:$(()=>[e("div",bt,[e("div",kt,[e("div",$t,[m(ce,{href:s.route("admin.rubrics.create")},{icon:$(()=>[St]),default:$(()=>[V(" "+n(a(f)("addRubric")),1)]),_:1},8,["href"]),h.rubricsCount?(v(),z(ne,{key:0,onChange:J})):D("",!0)]),h.rubricsCount?(v(),z(se,{key:0,modelValue:A.value,"onUpdate:modelValue":t[0]||(t[0]=o=>A.value=o),placeholder:a(f)("searchByName")},null,8,["modelValue","placeholder"])):D("",!0),h.rubricsCount?(v(),z(ee,{key:1},{default:$(()=>[V(n(h.rubricsCount),1)]),_:1})):D("",!0),m(wt,{rubrics:M.value,"selected-rubrics":c.value,onToggleActivity:I,onDelete:y,onClone:U,onUpdateSortOrder:N,onToggleSelect:K,onToggleAll:F},null,8,["rubrics","selected-rubrics"]),h.rubricsCount?(v(),x("div",Ct,[m(oe,{"items-per-page":u.value,"onUpdate:itemsPerPage":t[1]||(t[1]=o=>u.value=o)},null,8,["items-per-page"]),m(le,{"current-page":C.value,"items-per-page":u.value,"total-items":T.value.length,"onUpdate:currentPage":t[2]||(t[2]=o=>C.value=o),"onUpdate:itemsPerPage":t[3]||(t[3]=o=>u.value=o)},null,8,["current-page","items-per-page","total-items"]),m(be,{sortParam:i.value,"onUpdate:sortParam":t[4]||(t[4]=o=>i.value=o)},null,8,["sortParam"])])):D("",!0)])]),m(te,{show:S.value,onClose:r,onCancel:r,onConfirm:_,cancelText:a(f)("cancel"),confirmText:a(f)("yesDelete")},null,8,["show","cancelText","confirmText"])]),_:1},8,["title"]))}};export{Jt as default};
