import{u as M,l as x,z as H,a4 as I,m as i,o as c,f as e,F as k,v as C,q as B,n as $,p as V,t as u,k as o,N as A,O as Z,i as b,w as L,J as R,Q as T,G as z,e as P,aU as E}from"./vendor-BxBIhlnJ.js";import{_ as F}from"./DefaultLayout-B9BWOsR_.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as O}from"./vendor-axios-jn5v1YEJ.js";import"./vendor-lodash-BkjH9gY7.js";import"./ResponsiveNavLink-De0bHo2I.js";import"./LogoutButton-154m7eOH.js";import"./LocaleSelectOption-C-FbJBp9.js";import"./app-T6LOBsMh.js";const q=n=>(A("data-v-11c647ad"),n=n(),Z(),n),G={class:"relative w-full aspect-video bg-black rounded mb-4 shadow-lg shadow-gray-600 dark:shadow-gray-900 overflow-hidden"},J={key:0,class:"relative w-full h-full"},Q=["src","alt"],Y={class:"absolute inset-0 flex items-center justify-center z-20"},K=q(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-8 h-8 text-red-600",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M8 5v14l11-7z"})],-1)),W=[K],X=["innerHTML"],ee=["src"],te={key:2,class:"w-full h-full object-contain",controls:""},oe=["src"],se={__name:"VideoPlayer",props:{video:Object},emits:["play"],setup(n,{emit:f}){const w=n,{t}=M(),m=x(0),_=x(null),h=()=>{var a;v(),((a=w.video.images)==null?void 0:a.length)>1&&(_.value=setInterval(()=>{m.value=(m.value+1)%w.video.images.length},4e3))},v=()=>{_.value&&(clearInterval(_.value),_.value=null)};H(()=>{h()}),I(()=>{v()});const g=x(null),y=a=>{g.value=a,v()},l=a=>{const s=a.source_type,d=a.external_video_id;try{if(s==="youtube")return`https://www.youtube.com/embed/${new URL(d).searchParams.get("v")}`;if(s==="vimeo"){const r=d.match(/vimeo\.com\/(?:video\/)?(\d+)/);return r?`https://player.vimeo.com/video/${r[1]}`:null}if(s==="local")return a.video_url||`/storage/${d}`;if(s==="code")return a.video_code||a.embed_code||null}catch(r){return console.error("❌ Video URL error:",r),null}return null};return(a,s)=>{var d;return c(),i("div",G,[(d=n.video.images)!=null&&d.length&&g.value!==n.video.id?(c(),i("div",J,[(c(!0),i(k,null,C(n.video.images,(r,p)=>(c(),i("img",{key:r.id||p,src:r.url,alt:r.alt||n.video.title,class:B(["slide-fade w-full h-full object-cover",{"slide-fade-active":p===m.value}])},null,10,Q))),128)),e("div",Y,[e("button",{onClick:s[0]||(s[0]=r=>y(n.video.id)),class:"bg-white/30 hover:bg-white/40 backdrop-blur-md rounded-full p-2 border-8 border-white/30"},W)])])):(c(),i(k,{key:1},[n.video.source_type==="code"?(c(),i("div",{key:0,class:"w-full h-full",innerHTML:l(n.video)},null,8,X)):["youtube","vimeo"].includes(n.video.source_type)?(c(),i("iframe",{key:1,class:"w-full h-full",src:l(n.video),style:{width:"100% !important","aspect-ratio":"16 / 9 !important",display:"block !important"},frameborder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowfullscreen:""},null,8,ee)):n.video.source_type==="local"?(c(),i("video",te,[e("source",{src:l(n.video),type:"video/mp4"},null,8,oe),V(" "+u(o(t)("videoNotSupported")),1)])):$("",!0)],64))])}}},le=N(se,[["__scopeId","data-v-11c647ad"]]),ne=n=>(A("data-v-091c84cb"),n=n(),Z(),n),ae={key:0,class:"mt-4"},ce={class:"mb-4 tracking-wide text-center font-semibold text-lg text-black dark:text-white"},ie={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2 gap-3"},re={class:"relative w-full bg-black aspect-video overflow-hidden"},de={key:0,class:"relative w-full h-full"},ue=["src","alt"],he={class:"absolute inset-0 flex items-center justify-center z-20"},me=["onClick"],_e=ne(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-8 h-8 text-red-600",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M8 5v14l11-7z"})],-1)),ve=[_e],pe=["innerHTML"],fe=["src"],we={key:2,class:"w-full h-full object-contain",controls:""},ge=["src"],xe={class:"text-center text-sm font-semibold text-slate-800 dark:text-slate-100 pt-1"},ye={class:"pb-2 text-center text-xs text-slate-600 dark:text-slate-400"},be={__name:"RecommendedVideos",props:{videos:Array},setup(n){const f=n,{t:w}=M(),t=x({}),m=x({}),_=x({}),h=(l,a)=>{v(l),a>1&&(_.value[l]=setInterval(()=>{t.value[l]=(t.value[l]+1)%a},4e3))},v=l=>{_.value[l]&&(clearInterval(_.value[l]),delete _.value[l])},g=l=>{m.value[l]=!0,v(l)},y=l=>{const a=l.source_type,s=l.external_video_id;try{if(a==="youtube")return`https://www.youtube.com/embed/${new URL(s).searchParams.get("v")}`;if(a==="vimeo"){const d=s.match(/vimeo\.com\/(?:video\/)?(\d+)/);return d?`https://player.vimeo.com/video/${d[1]}`:null}if(a==="local")return l.video_url||`/storage/${s}`;if(a==="code")return l.video_code||l.embed_code||null}catch(d){return console.error("❌ Video URL error:",d),null}return null};return H(()=>{f.videos.forEach(l=>{var a;t.value[l.id]=0,((a=l.images)==null?void 0:a.length)>1&&h(l.id,l.images.length)})}),I(()=>{f.videos.forEach(l=>v(l.id))}),(l,a)=>n.videos&&n.videos.length>0?(c(),i("div",ae,[e("h2",ce,u(o(w)("relatedVideos")),1),e("div",ie,[(c(!0),i(k,null,C(n.videos,s=>{var d;return c(),i("div",{key:s.id,class:"relative flex flex-col rounded overflow-hidden bg-white dark:bg-slate-800 border-2 border-slate-400 shadow-md shadow-gray-600 dark:shadow-gray-900"},[e("div",re,[(d=s.images)!=null&&d.length&&!m.value[s.id]?(c(),i("div",de,[(c(!0),i(k,null,C(s.images,(r,p)=>(c(),i("img",{key:r.id||p,src:r.url,alt:r.alt||s.title,class:B(["slide-fade w-full h-full object-cover",{"slide-fade-active":p===t.value[s.id]}])},null,10,ue))),128)),e("div",he,[e("button",{onClick:r=>g(s.id),class:"bg-white/30 hover:bg-white/40 backdrop-blur-md rounded-full p-2 border-8 border-white/30"},ve,8,me)])])):(c(),i(k,{key:1},[s.source_type==="code"?(c(),i("div",{key:0,class:"w-full h-full",innerHTML:y(s)},null,8,pe)):["youtube","vimeo"].includes(s.source_type)?(c(),i("iframe",{key:1,class:"w-full h-full",src:y(s),style:{width:"100% !important","aspect-ratio":"16 / 9 !important",display:"block !important"},frameborder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowfullscreen:""},null,8,fe)):s.source_type==="local"?(c(),i("video",we,[e("source",{src:y(s),type:"video/mp4"},null,8,ge),V(" "+u(o(w)("videoNotSupported")),1)])):$("",!0)],64))]),e("div",xe,[b(o(R),{href:`/videos/${s.url}`,class:"block text-sm font-semibold text-slate-800 dark:text-slate-100 hover:text-red-600 hover:dark:text-red-400 transition"},{default:L(()=>[V(u(s.title),1)]),_:2},1032,["href"]),e("div",ye,u(s.published_at?new Date(s.published_at).toLocaleDateString():""),1)])])}),128))])])):$("",!0)}},ke=N(be,[["__scopeId","data-v-091c84cb"]]),$e={itemprop:"interactionStatistic",itemscope:"",itemtype:"http://schema.org/InteractionCounter"},Ve=e("meta",{itemprop:"interactionType",content:"http://schema.org/LikeAction"},null,-1),Se=["content"],Le=["title"],Me=e("path",{d:"M3,9H1a1,1,0,0,0-1,1V22a1,1,0,0,0,1,1H4V10A1,1,0,0,0,3,9Z"},null,-1),Ce=e("path",{d:"M21.882,8.133A2.986,2.986,0,0,0,21,8H15V5c0-3.824-2.589-4.942-3.958-5a1.017,1.017,0,0,0-.734.277A1,1,0,0,0,10,1V5.638l-4,4.8V23H18.23A2.985,2.985,0,0,0,21.1,20.882l2.769-9A3,3,0,0,0,21.882,8.133Z"},null,-1),He=[Me,Ce],Ie={class:"ml-1 font-semibold text-xs dark:text-slate-100"},Be={__name:"LikeButtonVideo",setup(n){const{t:f}=M(),{video:w}=T().props,t=x(w.likes),m=x(!1),_=()=>{m.value||O.post(route("videos.like",w.id)).then(h=>{h.data.success?(t.value=h.data.likes,m.value=!0):(m.value=!0,alert(h.data.message||f("already_liked")))}).catch(h=>{console.error("Ошибка лайка:",h)})};return(h,v)=>(c(),i("div",$e,[Ve,e("meta",{itemprop:"userInteractionCount",content:t.value},null,8,Se),e("div",{title:o(f)("like"),class:"w-fit flex flex-row items-center justify-center cursor-pointer"},[(c(),i("svg",{onClick:_,class:"w-4 h-4 fill-current text-red-400 dark:text-red-200 hover:text-yellow-500 active:text-red-500 dark:active:text-red-300 transition-all duration-200 transform",viewBox:"0 0 24 24"},He)),e("span",Ie,u(t.value),1)],8,Le)]))}},je=["content"],De=["content"],Ue=["content"],Ae=["content"],Ze=e("meta",{name:"viewport",content:"width=device-width, initial-scale=1"},null,-1),Re=["content"],Te=["content"],Ne=e("meta",{property:"og:type",content:"video"},null,-1),ze=["content"],Pe=["content"],Ee=["content"],Fe=e("meta",{name:"twitter:card",content:"summary_large_image"},null,-1),Oe=["content"],qe=["content"],Ge=["content"],Je=["content"],Qe=["content"],Ye=["content"],Ke={class:"text-sm mb-4","aria-label":"Breadcrumb"},We={class:"list-reset flex items-center space-x-0"},Xe=e("li",null,[e("span",{class:"mx-1 text-slate-900 dark:text-slate-100"},"/")],-1),et={class:"text-slate-900 dark:text-slate-100"},tt={class:"flex items-center justify-center my-4 text-center font-bolder text-xl text-slate-900 dark:text-slate-100"},ot=e("svg",{class:"w-4 h-4 fill-current text-blue-400 dark:text-indigo-300 mr-2",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M0 0h2v16H0V0Zm14 0h2v16h-2V0Zm-3 7H5c-.6 0-1-.4-1-1V1c0-.6.4-1 1-1h6c.6 0 1 .4 1 1v5c0 .6-.4 1-1 1ZM6 5h4V2H6v3Zm5 11H5c-.6 0-1-.4-1-1v-5c0-.6.4-1 1-1h6c.6 0 1 .4 1 1v5c0 .6-.4 1-1 1Zm-5-2h4v-3H6v3Z"})],-1),st=["title"],lt={class:"flex-1"},nt={class:"flex flex-row items-center justify-between"},at=["datetime"],ct={key:0,class:"flex items-center my-4 tracking-wide text-sm font-semibold text-black dark:text-white"},it=["innerHTML"],wt={__name:"Show",setup(n){const{t:f}=M(),{appUrl:w,video:t,recommendedVideos:m,locale:_,siteSettings:h}=T().props,v=x(!1);let g;const y=()=>{v.value=document.documentElement.classList.contains("dark")};H(()=>{y(),g=new MutationObserver(y),g.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]})}),I(()=>{g&&g.disconnect()});const l=z(()=>v.value?h.PublicDarkBackgroundColor:h.PublicLightBackgroundColor),a=s=>{const d=new Date(s),r=String(d.getDate()).padStart(2,"0"),p=String(d.getMonth()+1).padStart(2,"0"),S=d.getFullYear();return`${r}.${p}.${S}`};return(s,d)=>(c(),P(F,{title:o(t).title,"can-login":s.$page.props.canLogin,"can-register":s.$page.props.canRegister},{default:L(()=>[b(o(E),null,{default:L(()=>{var r,p,S,j,D,U;return[e("title",null,u(o(t).title),1),e("meta",{name:"title",content:o(t).title||""},null,8,je),e("meta",{name:"description",content:o(t).meta_desc||""},null,8,De),e("meta",{name:"keywords",content:o(t).meta_keywords||""},null,8,Ue),e("meta",{name:"author",content:o(t).author||""},null,8,Ae),Ze,e("meta",{property:"og:title",content:o(t).title||""},null,8,Re),e("meta",{property:"og:description",content:o(t).meta_desc||""},null,8,Te),Ne,e("meta",{property:"og:url",content:`/videos/${o(t).url}`},null,8,ze),e("meta",{property:"og:image",content:((p=(r=o(t).images)==null?void 0:r[0])==null?void 0:p.url)||""},null,8,Pe),e("meta",{property:"og:locale",content:o(t).locale||"ru_RU"},null,8,Ee),Fe,e("meta",{name:"twitter:title",content:o(t).title||""},null,8,Oe),e("meta",{name:"twitter:description",content:o(t).meta_desc||""},null,8,qe),e("meta",{name:"twitter:image",content:((j=(S=o(t).images)==null?void 0:S[0])==null?void 0:j.url)||""},null,8,Ge),e("meta",{itemprop:"name",content:o(t).title||""},null,8,Je),e("meta",{itemprop:"description",content:o(t).meta_desc||""},null,8,Qe),e("meta",{itemprop:"image",content:((U=(D=o(t).images)==null?void 0:D[0])==null?void 0:U.url)||""},null,8,Ye)]}),_:1}),e("div",{class:B(["flex-1 p-4",[l.value]])},[e("nav",Ke,[e("ol",We,[e("li",null,[b(o(R),{href:"/",class:"hover:underline text-slate-900 dark:text-slate-100"},{default:L(()=>[V(u(o(f)("home")),1)]),_:1})]),Xe,e("li",et,u(o(t).title),1)])]),e("h1",tt,[ot,V(" "+u(o(t).title)+" ",1),e("div",{class:"ml-2 w-6 h-5 flex items-center justify-center rounded-full text-[9px] font-semibold text-black dark:text-white bg-slate-100 dark:bg-slate-700",title:o(f)("views")},u(o(t).views),9,st)]),e("div",lt,[b(le,{video:o(t)},null,8,["video"]),e("div",nt,[e("time",{datetime:a(o(t).published_at),class:"opacity-75 text-left text-xs font-semibold text-slate-600 dark:text-slate-400"},u(o(f)("publishedAt"))+": "+u(a(o(t).published_at)),9,at),b(Be)]),o(t).short?(c(),i("p",ct,u(o(t).short),1)):$("",!0),o(t).description?(c(),i("div",{key:1,class:"w-full mx-auto my-4 dark:text-slate-200",innerHTML:o(t).description,itemprop:"articleBody"},null,8,it)):$("",!0)]),b(ke,{videos:o(m),formatDate:a},null,8,["videos"])],2)]),_:1},8,["title","can-login","can-register"]))}};export{wt as default};
