import{u as k,y as w,l as h,z as C,e as B,o as c,w as f,f as e,m as v,n as A,t as i,k as d,K as F,F as D,v as T,i as N,p as V}from"./vendor-BEBDZ0sp.js";import{a as m}from"./vendor-axios-jn5v1YEJ.js";import{A as $}from"./AdminLayout-DSdOfU-D.js";import{T as z}from"./TitlePage-DJKfB1_5.js";import"./vendor-lodash-CeR_jfIo.js";import"./ScrollButtons-BQPx4wk5.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ResponsiveNavLink-fXlkiuVz.js";import"./LocaleSelectOption-B6VJrWhn.js";import"./app-DJPVAKIM.js";import"./auth-image-XbvYdkSi.js";const L={class:"px-4 sm:px-6 lg:px-8 py-8 w-full max-w-12xl mx-auto"},R={class:"p-4 bg-slate-50 dark:bg-slate-700 border border-blue-400 dark:border-blue-200 overflow-hidden shadow-lg shadow-gray-500 dark:shadow-slate-400 bg-opacity-95 dark:bg-opacity-95"},S={class:"mb-4"},M=["disabled"],P={key:0,class:"mb-4 w-full"},j={class:"text-sm font-medium text-blue-700 dark:text-blue-200 mb-1"},E={class:"w-full h-3 bg-gray-300 dark:bg-gray-600 rounded-full overflow-hidden"},I={class:"text-slate-700 dark:text-slate-200 text-center text-md font-semibold mb-2"},K={key:0,class:"divide-y border rounded"},q={class:"font-medium text-sm text-amber-700 dark:text-amber-200"},G={class:"text-xs text-gray-500 dark:text-gray-400"},H={class:"flex items-center space-x-2"},J=["onClick","disabled"],O=["onClick"],Q=["onClick","disabled"],U={key:1,class:"text-gray-500 text-center"},ne={__name:"FileBackup",setup(W){const{t}=k(),r=w(),s=h(!1),o=h(0),l=h(0),u=h([]),b=async()=>{try{const a=await m.get(route("admin.files.list"));console.log("📦 archives response:",a.data),u.value=a.data.archives||[]}catch(a){console.error("❌ Failed to load archives:",a),r.error(t("failedToLoadBackups")),u.value=[]}},_=async()=>{s.value=!0,l.value=1,o.value=25;try{await m.post(route("admin.files.create")),l.value=2,o.value=100,r.success(t("archiveCreated")),await b(),setTimeout(()=>{l.value=0,o.value=0,s.value=!1},3e3)}catch{r.error(t("archiveCreateFailed")),l.value=0,o.value=0,s.value=!1}},g=async a=>{if(a){s.value=!0,l.value=1,o.value=25;try{await m.post(route("admin.files.restore"),{file:a}),l.value=2,o.value=100,r.success(t("archiveRestored")),setTimeout(()=>{l.value=0,o.value=0,s.value=!1},3e3)}catch{r.error(t("archiveRestoreFailed")),l.value=0,o.value=0,s.value=!1}}},x=async a=>{if(!(!a||!confirm(t("backupConfirmDeleteBackup")))){s.value=!0;try{await m.delete(route("admin.files.delete"),{data:{file:a}}),r.success(t("backupDeleted")),await b()}catch{r.error(t("backupDeleteFailed"))}finally{s.value=!1}}},y=a=>{window.open(route("admin.files.download",{file:a}),"_blank")};return C(b),(a,X)=>(c(),B($,{title:d(t)("fileBackup")},{header:f(()=>[N(z,null,{default:f(()=>[V(i(d(t)("fileBackup")),1)]),_:1})]),default:f(()=>[e("div",L,[e("div",R,[e("div",S,[e("button",{onClick:_,disabled:s.value,class:"btn bg-sky-600 hover:bg-sky-700 text-white px-4 py-1 text-sm rounded shadow"},i(d(t)("createArchive")),9,M)]),l.value>0?(c(),v("div",P,[e("div",j,i(l.value===1?d(t)("archivingStep"):l.value===2?d(t)("archivingDone"):""),1),e("div",E,[e("div",{class:"h-full bg-blue-600 transition-all duration-500",style:F({width:`${o.value}%`})},null,4)])])):A("",!0),e("div",null,[e("h2",I,i(d(t)("availableArchives")),1),Array.isArray(u.value.value)&&u.value.value.length?(c(),v("ul",K,[(c(!0),v(D,null,T(u.value,n=>(c(),v("li",{key:n.name,class:"flex items-center justify-between px-3 py-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-slate-800"},[e("div",null,[e("div",q,i(n.name),1),e("div",G,i((n.size/1024/1024).toFixed(2))+" MB ",1)]),e("div",H,[e("button",{onClick:p=>g(n.name),disabled:s.value,class:"w-8 h-8 bg-teal-500 hover:bg-teal-600 text-white rounded-sm"}," 🔄 ",8,J),e("button",{onClick:p=>y(n.name),class:"w-8 h-8 bg-blue-500 hover:bg-blue-600 text-white rounded-sm"}," ⬇️ ",8,O),e("button",{onClick:p=>x(n.name),disabled:s.value,class:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-sm"}," 🗑️ ",8,Q)])]))),128))])):(c(),v("div",U,i(d(t)("noData")),1))])])])]),_:1},8,["title"]))}};export{ne as default};
