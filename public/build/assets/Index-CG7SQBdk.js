import{u as I,m as w,o as m,f as e,t as i,k as a,l as b,C as N,i as v,w as A,F as ee,v as te,D as se,y as oe,E as x,G as V,e as z,n as E,p as U}from"./vendor-CMULZhQa.js";import{A as le}from"./AdminLayout-BMfLiLo0.js";import{T as ae}from"./TitlePage-DOI2IMRH.js";import{_ as ie}from"./DefaultButton-CB_WTPCQ.js";import{_ as re,a as ne,b as ce}from"./CountTable-CMYQTUCB.js";import{_ as de,a as ue,b as pe}from"./SearchInput-2uRN4F4q.js";import{_ as he,a as ve}from"./RightToggle-9WUSzSx_.js";import{_ as fe}from"./MainToggle-C7uIJuHi.js";import{_ as me}from"./ActivityToggle-Cte8AC4X.js";import{_ as _e}from"./CloneIconButton-Bv9NdoW1.js";import{_ as ge}from"./IconEdit-C4DN4M8M.js";import{a as P}from"./vendor-axios-jn5v1YEJ.js";import"./vendor-lodash-3g6-h99u.js";import"./sidebarIcons-D5nT6JI0.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ResponsiveNavLink-BBt1gw6L.js";import"./ScrollButtons-DjRj6zOj.js";import"./app-BmuzEqX8.js";import"./auth-image-XbvYdkSi.js";const xe={class:"flex justify-center items-center h-fit sm:mr-4 mt-2 mb-2"},ye={for:"sortParam",class:"hidden lg:block sm:mr-2 tracking-wider text-sm font-semibold text-slate-600 dark:text-slate-100"},we=["value"],$e={value:"idDesc"},be={value:"idAsc"},ke={value:"published_at"},Ae={value:"sort"},Se={value:"title"},Te={value:"locale"},Ce={value:"views"},Me={value:"likes"},De={value:"activity"},Le={value:"inactive"},ze={value:"left"},Ee={value:"noLeft"},Pe={value:"main"},Ie={value:"noMain"},Be={value:"right"},Re={value:"noRight"},Ve={__name:"SortSelect",props:{sortParam:String},emits:["update:sortParam"],setup(_,{emit:g}){const{t:o}=I(),$=g,p=n=>{$("update:sortParam",n.target.value)};return(n,y)=>(m(),w("div",xe,[e("label",ye,i(a(o)("sort")),1),e("select",{id:"sortParam",value:_.sortParam,onChange:p,class:"w-50 px-3 py-0.5 form-select bg-white dark:bg-gray-200 text-gray-600 dark:text-gray-900 border border-slate-400 dark:border-slate-600 rounded-sm shadow-sm"},[e("option",$e,i(a(o)("idDesc")),1),e("option",be,i(a(o)("idAsc")),1),e("option",ke,i(a(o)("publishedAt")),1),e("option",Ae,i(a(o)("sortNumber")),1),e("option",Se,i(a(o)("title")),1),e("option",Te,i(a(o)("localization")),1),e("option",Ce,i(a(o)("views")),1),e("option",Me,i(a(o)("likes")),1),e("option",De,i(a(o)("active")),1),e("option",Le,i(a(o)("inactive")),1),e("option",ze,i(a(o)("inLeft")),1),e("option",Ee,i(a(o)("notLeft")),1),e("option",Pe,i(a(o)("inMain")),1),e("option",Ie,i(a(o)("notMain")),1),e("option",Be,i(a(o)("inRight")),1),e("option",Re,i(a(o)("notRight")),1)],40,we)]))}},Ue={class:"bg-white dark:bg-slate-700 shadow-lg rounded-sm border border-slate-200 dark:border-slate-600 relative"},Ne={class:"overflow-x-auto"},je={key:0,class:"table-auto w-full text-slate-700 dark:text-slate-100"},Fe={class:"text-sm uppercase bg-slate-200 dark:bg-cyan-900 border border-solid border-gray-300 dark:border-gray-700"},He=e("th",{class:"px-2 py-3 w-px"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4 fill-current text-slate-800 dark:text-slate-200",height:"24",width:"24",viewBox:"0 0 24 24"},[e("path",{d:"M12.707,2.293a1,1,0,0,0-1.414,0l-5,5A1,1,0,0,0,7.707,8.707L12,4.414l4.293,4.293a1,1,0,0,0,1.414-1.414Z"}),e("path",{d:"M16.293,15.293,12,19.586,7.707,15.293a1,1,0,0,0-1.414,1.414l5,5a1,1,0,0,0,1.414,0l5-5a1,1,0,0,0-1.414-1.414Z"})])],-1),Ke={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap w-px"},Je={class:"font-medium text-center"},Ze={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},Ge=["title"],Qe=e("svg",{class:"w-6 h-6 fill-current shrink-0",viewBox:"0 0 512 512"},[e("path",{d:"M0 96C0 60.7 28.7 32 64 32l384 0c35.3 0 64 28.7 64 64l0 320c0 35.3-28.7 64-64 64L64 480c-35.3 0-64-28.7-64-64L0 96zM323.8 202.5c-4.5-6.6-11.9-10.5-19.8-10.5s-15.4 3.9-19.8 10.5l-87 127.6L170.7 297c-4.6-5.7-11.5-9-18.7-9s-14.2 3.3-18.7 9l-64 80c-5.8 7.2-6.9 17.1-2.9 25.4s12.4 13.6 21.6 13.6l96 0 32 0 208 0c8.9 0 17.1-4.9 21.2-12.8s3.6-17.4-1.4-24.7l-120-176zM112 192a48 48 0 1 0 0-96 48 48 0 1 0 0 96z"})],-1),qe=[Qe],We={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},Xe=["title"],Ye=e("svg",{class:"w-8 h-8 fill-current shrink-0",viewBox:"0 0 640 512"},[e("path",{d:"M0 128C0 92.7 28.7 64 64 64l192 0 48 0 16 0 256 0c35.3 0 64 28.7 64 64l0 256c0 35.3-28.7 64-64 64l-256 0-16 0-48 0L64 448c-35.3 0-64-28.7-64-64L0 128zm320 0l0 256 256 0 0-256-256 0zM178.3 175.9c-3.2-7.2-10.4-11.9-18.3-11.9s-15.1 4.7-18.3 11.9l-64 144c-4.5 10.1 .1 21.9 10.2 26.4s21.9-.1 26.4-10.2l8.9-20.1 73.6 0 8.9 20.1c4.5 10.1 16.3 14.6 26.4 10.2s14.6-16.3 10.2-26.4l-64-144zM160 233.2L179 276l-38 0 19-42.8zM448 164c11 0 20 9 20 20l0 4 44 0 16 0c11 0 20 9 20 20s-9 20-20 20l-2 0-1.6 4.5c-8.9 24.4-22.4 46.6-39.6 65.4c.9 .6 1.8 1.1 2.7 1.6l18.9 11.3c9.5 5.7 12.5 18 6.9 27.4s-18 12.5-27.4 6.9l-18.9-11.3c-4.5-2.7-8.8-5.5-13.1-8.5c-10.6 7.5-21.9 14-34 19.4l-3.6 1.6c-10.1 4.5-21.9-.1-26.4-10.2s.1-21.9 10.2-26.4l3.6-1.6c6.4-2.9 12.6-6.1 18.5-9.8l-12.2-12.2c-7.8-7.8-7.8-20.5 0-28.3s20.5-7.8 28.3 0l14.6 14.6 .5 .5c12.4-13.1 22.5-28.3 29.8-45L448 228l-72 0c-11 0-20-9-20-20s9-20 20-20l52 0 0-4c0-11 9-20 20-20z"})],-1),Oe=[Ye],et={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},tt={class:"font-medium text-left"},st={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},ot={class:"font-medium text-left"},lt={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},at=["title"],it=e("svg",{class:"w-4 h-4 fill-current shrink-0",viewBox:"0 0 16 16"},[e("path",{d:"M8 2C3.246 2 .251 7.29.127 7.515a.998.998 0 0 0 .002.975c.07.125 1.044 1.801 2.695 3.274C4.738 13.582 6.283 14 8 14c4.706 0 7.743-5.284 7.872-5.507a1 1 0 0 0 0-.98A13.292 13.292 0 0 0 8 2zm0 10a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm0-6a2 2 0 1 0 0 4 2 2 0 0 0 0-4z"})],-1),rt=[it],nt={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},ct=["title"],dt=e("svg",{class:"h-8 w-8 fill-current",viewBox:"0 0 32 32"},[e("path",{d:"M22.682 11.318A4.485 4.485 0 0019.5 10a4.377 4.377 0 00-3.5 1.707A4.383 4.383 0 0012.5 10a4.5 4.5 0 00-3.182 7.682L16 24l6.682-6.318a4.5 4.5 0 000-6.364zm-1.4 4.933L16 21.247l-5.285-5A2.5 2.5 0 0112.5 12c1.437 0 2.312.681 3.5 2.625C17.187 12.681 18.062 12 19.5 12a2.5 2.5 0 011.785 4.251h-.003z"})],-1),ut=[dt],pt={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},ht={class:"font-medium text-center"},vt={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},ft={class:"font-medium text-center"},mt={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},_t={class:"text-center"},gt={class:"text-sm font-semibold border-b-2 hover:bg-slate-100 dark:hover:bg-cyan-800"},xt=e("td",{class:"px-2 py-1 text-center cursor-move handle"},[e("svg",{class:"w-4 h-4 text-gray-500 dark:text-gray-300",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M7 4h2v2H7V4zm4 0h2v2h-2V4zM7 8h2v2H7V8zm4 0h2v2h-2V8zM7 12h2v2H7v-2zm4 0h2v2h-2v-2z"})])],-1),yt={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},wt={class:"text-center text-blue-600 dark:text-blue-200"},$t={class:"first:pl-5 last:pr-5 py-1"},bt={class:"flex justify-center"},kt=["src","alt","title"],At=["alt"],St={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},Tt={class:"text-center uppercase text-orange-500 dark:text-orange-200"},Ct={class:"px-2 first:pl-7 last:pr-7 py-1 whitespace-nowrap"},Mt={class:"text-left"},Dt=["href","title"],Lt={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},zt={class:"text-left"},Et=["title"],Pt={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},It={class:"text-center"},Bt={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},Rt={class:"text-center"},Vt={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},Ut={class:"flex justify-center space-x-2"},Nt={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},jt={class:"flex justify-center space-x-2"},Ft={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},Ht={class:"text-center"},Kt=["checked","onChange"],Jt={key:1,class:"p-5 text-center text-slate-700 dark:text-slate-100"},Zt={__name:"ArticleTable",props:{articles:Array,tags:Array,selectedArticles:Array},emits:["toggle-left","toggle-main","toggle-right","toggle-activity","edit","delete","update-sort-order","clone","toggle-select","toggle-all"],setup(_,{emit:g}){const{t:o}=I(),$=_,p=g,n=d=>{if(!d)return"";const h=new Date(d);return isNaN(h)?"":h.toLocaleDateString("ru-RU",{year:"numeric",month:"long",day:"numeric"})},y=b([]);N(()=>$.articles,d=>{y.value=JSON.parse(JSON.stringify(d||[]))},{immediate:!0,deep:!0});const k=()=>{const d=y.value.map(h=>h.id);p("update-sort-order",d)},S=d=>{const h=d.target.checked,r=y.value.map(f=>f.id);p("toggle-all",{ids:r,checked:h})},T=d=>d.images&&d.images.length?[...d.images].sort((h,r)=>h.order-r.order)[0]:null,C=(d,h=30)=>d?d.length>h?d.slice(0,h).trimEnd()+"…":d:"";return(d,h)=>(m(),w("div",Ue,[e("div",Ne,[_.articles.length>0?(m(),w("table",je,[e("thead",Fe,[e("tr",null,[He,e("th",Ke,[e("div",Je,i(a(o)("id")),1)]),e("th",Ze,[e("div",{class:"flex justify-center",title:a(o)("image")},qe,8,Ge)]),e("th",We,[e("div",{class:"flex justify-center",title:a(o)("localization")},Oe,8,Xe)]),e("th",et,[e("div",tt,i(a(o)("title")),1)]),e("th",st,[e("div",ot,i(a(o)("sections")),1)]),e("th",lt,[e("div",{class:"flex justify-center",title:a(o)("views")},rt,8,at)]),e("th",nt,[e("div",{class:"flex justify-center",title:a(o)("likes")},ut,8,ct)]),e("th",pt,[e("div",ht,i(a(o)("show")),1)]),e("th",vt,[e("div",ft,i(a(o)("actions")),1)]),e("th",mt,[e("div",_t,[e("input",{type:"checkbox",onChange:S},null,32)])])])]),v(a(se),{tag:"tbody",modelValue:y.value,"onUpdate:modelValue":h[0]||(h[0]=r=>y.value=r),onEnd:k,itemKey:"id",handle:".handle"},{item:A(({element:r})=>[e("tr",gt,[xt,e("td",yt,[e("div",wt,i(r.id),1)]),e("td",$t,[e("div",bt,[r.images&&r.images.length?(m(),w("img",{key:0,src:T(r).webp_url||T(r).url,alt:T(r).alt||a(o)("defaultImageAlt"),title:T(r).caption||a(o)("postImage"),class:"h-6 w-8 object-cover rounded-xs"},null,8,kt)):(m(),w("img",{key:1,src:"/storage/article_images/default-image.png",alt:a(o)("defaultImageTitle"),class:"h-6 w-8 object-cover rounded-xs"},null,8,At))])]),e("td",St,[e("div",Tt,i(r.locale),1)]),e("td",Ct,[e("div",Mt,[e("a",{href:`/articles/${encodeURIComponent(r.url)}`,class:"text-teal-600 dark:text-violet-200 hover:underline hover:text-teal-800 dark:hover:text-violet-50",target:"_blank",rel:"noopener noreferrer",title:n(r.published_at)},i(C(r.title,30)),9,Dt)])]),e("td",Lt,[e("div",zt,[(m(!0),w(ee,null,te(r.sections,f=>(m(),w("span",{key:f.id},[e("span",{title:f.title,class:"py-0.5 px-1.5 mr-0.5 badge bg-blue-500 dark:bg-blue-200 rounded-sm text-xs text-slate-100 dark:text-slate-900"},i(f.id),9,Et)]))),128))])]),e("td",Pt,[e("div",It,i(r.views),1)]),e("td",Bt,[e("div",Rt,i(r.likes_count),1)]),e("td",Vt,[e("div",Ut,[v(he,{isActive:r.left,onToggleLeft:f=>d.$emit("toggle-left",r),title:r.left?a(o)("enabled"):a(o)("disabled")},null,8,["isActive","onToggleLeft","title"]),v(fe,{isActive:r.main,onToggleMain:f=>d.$emit("toggle-main",r),title:r.main?a(o)("enabled"):a(o)("disabled")},null,8,["isActive","onToggleMain","title"]),v(ve,{isActive:r.right,onToggleRight:f=>d.$emit("toggle-right",r),title:r.right?a(o)("enabled"):a(o)("disabled")},null,8,["isActive","onToggleRight","title"])])]),e("td",Nt,[e("div",jt,[v(me,{isActive:r.activity,onToggleActivity:f=>d.$emit("toggle-activity",r),title:r.activity?a(o)("enabled"):a(o)("disabled")},null,8,["isActive","onToggleActivity","title"]),v(_e,{onClone:f=>d.$emit("clone",r)},null,8,["onClone"]),v(ge,{href:d.route("admin.articles.edit",r.id)},null,8,["href"]),v(re,{onDelete:f=>d.$emit("delete",r.id)},null,8,["onDelete"])])]),e("td",Ft,[e("div",Ht,[e("input",{type:"checkbox",checked:_.selectedArticles.includes(r.id),onChange:f=>d.$emit("toggle-select",r.id)},null,40,Kt)])])])]),_:1},8,["modelValue"])])):(m(),w("div",Jt,i(a(o)("noData")),1))])]))}},Gt={class:"flex flex-col sm:flex-row items-center"},Qt={class:"block mb-2 sm:mb-0 sm:mr-2 font-semibold text-sm text-slate-700 dark:text-slate-500"},qt={value:"",disabled:"",selected:""},Wt={value:"selectAll"},Xt={value:"deselectAll"},Yt={value:"activate"},Ot={value:"deactivate"},es={value:"left"},ts={value:"noLeft"},ss={value:"main"},os={value:"noMain"},ls={value:"right"},as={value:"noRight"},is={value:"delete"},rs={__name:"BulkActionSelect",props:{handleBulkAction:Function},emits:["change"],setup(_,{emit:g}){const{t:o}=I();return($,p)=>(m(),w("div",Gt,[e("label",Qt,i(a(o)("bulkActions")),1),e("select",{class:"w-auto px-3 py-0.5 form-select bg-white dark:bg-gray-200 text-gray-600 dark:text-gray-900 border border-slate-400 dark:border-slate-600 rounded-sm shadow-sm",onChange:p[0]||(p[0]=n=>$.$emit("change",n))},[e("option",qt,i(a(o)("selectAction")),1),e("option",Wt,i(a(o)("selectAll")),1),e("option",Xt,i(a(o)("deselectAll")),1),e("option",Yt,i(a(o)("activate")),1),e("option",Ot,i(a(o)("deactivate")),1),e("option",es,i(a(o)("left")),1),e("option",ts,i(a(o)("noLeft")),1),e("option",ss,i(a(o)("main")),1),e("option",os,i(a(o)("noMain")),1),e("option",ls,i(a(o)("right")),1),e("option",as,i(a(o)("noRight")),1),e("option",is,i(a(o)("deleteSelected")),1)],32)]))}},ns={class:"px-2 py-2 w-full max-w-12xl mx-auto"},cs={class:"p-4 bg-slate-50 dark:bg-slate-700 border border-blue-400 dark:border-blue-200 overflow-hidden shadow-md shadow-gray-500 dark:shadow-slate-400 bg-opacity-95 dark:bg-opacity-95"},ds={class:"sm:flex sm:justify-between sm:items-center mb-2"},us=e("svg",{class:"w-4 h-4 fill-current opacity-50 shrink-0",viewBox:"0 0 16 16"},[e("path",{d:"M15 7H9V1c0-.6-.4-1-1-1S7 .4 7 1v6H1c-.6 0-1 .4-1 1s.4 1 1 1h6v6c0 .6.4 1 1 1s1-.4 1-1V9h6c.6 0 1-.4 1-1s-.4-1-1-1z"})],-1),ps={key:2,class:"flex justify-between items-center flex-col md:flex-row my-1"},zs={__name:"Index",props:["articles","articlesCount","adminCountArticles","adminSortArticles"],setup(_){const{t:g}=I(),o=oe(),$=_,p=b($.adminCountArticles);N(p,s=>{x.put(route("admin.settings.updateAdminCountArticles"),{value:s},{preserveScroll:!0,preserveState:!0,onSuccess:()=>o.info(`Показ ${s} элементов на странице.`),onError:t=>o.error(t.value||"Ошибка обновления кол-ва элементов.")})});const n=b($.adminSortArticles);N(n,s=>{x.put(route("admin.settings.updateAdminSortArticles"),{value:s},{preserveScroll:!0,preserveState:!0,onSuccess:()=>o.info("Сортировка успешно изменена"),onError:t=>o.error(t.value||"Ошибка обновления сортировки.")})});const y=b(!1),k=b(null),S=b(""),T=(s,t)=>{k.value=s,S.value=t,y.value=!0},C=()=>{y.value=!1,k.value=null,S.value=""},d=()=>{if(k.value===null)return;const s=k.value,t=S.value;x.delete(route("admin.articles.destroy",{article:s}),{preserveScroll:!0,preserveState:!1,onSuccess:l=>{C(),o.success(`Статья "${t||"ID: "+s}" удалена.`)},onError:l=>{C();const u=l.general||l[Object.keys(l)[0]]||"Произошла ошибка при удалении.";o.error(`${u} (Статья: ${t||"ID: "+s})`),console.error("Ошибка удаления:",l)},onFinish:()=>{k.value=null,S.value=""}})},h=s=>{const t=!s.left,l=t?"активирована в левой колонке":"деактивирована в левой колонке";x.put(route("admin.actions.articles.updateLeft",{article:s.id}),{left:t},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{o.success(`Статья "${s.title}" ${l}.`)},onError:u=>{o.error(u.left||u.general||`Ошибка изменения активности для "${s.title}".`)}})},r=s=>{const t=!s.main,l=t?"активирована в главном":"деактивирована в главном";x.put(route("admin.actions.articles.updateMain",{article:s.id}),{main:t},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{o.success(`Статья "${s.title}" ${l}.`)},onError:u=>{o.error(u.main||u.general||`Ошибка изменения активности для "${s.title}".`)}})},f=s=>{const t=!s.right,l=t?"активирована в правой колонке":"деактивирована в правой колонке";x.put(route("admin.actions.articles.updateRight",{article:s.id}),{right:t},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{o.success(`Статья "${s.title}" ${l}.`)},onError:u=>{o.error(u.right||u.general||`Ошибка изменения активности для "${s.title}".`)}})},J=s=>{const t=!s.activity,l=g(t?"activated":"deactivated");x.put(route("admin.actions.articles.updateActivity",{article:s.id}),{activity:t},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{o.success(`Статья "${s.title}" ${l}.`)},onError:u=>{o.error(u.activity||u.general||`Ошибка изменения активности для "${s.title}".`)}})},Z=s=>{const t=s==null?void 0:s.id,l=(s==null?void 0:s.title)||`ID: ${t}`;if(typeof t>"u"||t===null){console.error("Не удалось получить ID статьи для клонирования",s),o.error("Не удалось определить статью для клонирования.");return}confirm(`Вы уверены, что хотите клонировать статью "${l}"?`)&&x.post(route("admin.actions.articles.clone",{article:t}),{},{preserveScroll:!0,preserveState:!1,onSuccess:u=>{o.success(`Статья "${l}" успешно клонирована.`)},onError:u=>{const R=Object.keys(u)[0],O=u[R]||`Ошибка клонирования статьи "${l}".`;o.error(O)}})},D=b(1),L=b(""),G=s=>n.value==="idAsc"?s.slice().sort((t,l)=>t.id-l.id):n.value==="idDesc"?s.slice().sort((t,l)=>l.id-t.id):n.value==="published_at"?s.slice().sort((t,l)=>t.id-l.id):n.value==="activity"?s.filter(t=>t.activity):n.value==="inactive"?s.filter(t=>!t.activity):n.value==="left"?s.filter(t=>t.left):n.value==="noLeft"?s.filter(t=>!t.left):n.value==="main"?s.filter(t=>t.main):n.value==="noMain"?s.filter(t=>!t.main):n.value==="right"?s.filter(t=>t.right):n.value==="noRight"?s.filter(t=>!t.right):n.value==="locale"?s.slice().sort((t,l)=>t.locale<l.locale?1:t.locale>l.locale?-1:0):n.value==="views"||n.value==="likes"?s.slice().sort((t,l)=>l[n.value]-t[n.value]):s.slice().sort((t,l)=>t[n.value]<l[n.value]?-1:t[n.value]>l[n.value]?1:0),B=V(()=>{let s=$.articles;return L.value&&(s=s.filter(t=>t.title.toLowerCase().includes(L.value.toLowerCase()))),G(s)}),M=V(()=>{const s=(D.value-1)*p.value;return B.value.slice(s,s+p.value)});V(()=>Math.ceil(B.value.length/p.value));const Q=s=>{const t=(D.value-1)*p.value,l=s.map((u,R)=>({id:u,sort:t+R+1}));x.put(route("admin.actions.articles.updateSortBulk"),{articles:l},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{o.success("Порядок статей успешно обновлен.")},onError:u=>{console.error("Ошибка обновления сортировки:",u),o.error(u.general||u.articles||"Не удалось обновить порядок статей."),x.reload({only:["articles"],preserveScroll:!0})}})},c=b([]),q=({ids:s,checked:t})=>{t?c.value=[...new Set([...c.value,...s])]:c.value=c.value.filter(l=>!s.includes(l))},W=s=>{const t=c.value.indexOf(s);t>-1?c.value.splice(t,1):c.value.push(s)},j=s=>{if(!c.value.length){o.warning("Выберите статьи для активации/деактивации статьи");return}P.put(route("admin.actions.articles.bulkUpdateActivity"),{ids:c.value,activity:s}).then(()=>{o.success("Активность массово обновлена");const t=[...c.value];c.value=[],M.value.forEach(l=>{t.includes(l.id)&&(l.activity=s)})}).catch(()=>{o.error("Не удалось обновить активность")})},F=s=>{if(c.value.length===0){o.warning(`Выберите статьи для ${s?"активации в левой колонки":"деактивации в левой колонки"}.`);return}P.put(route("admin.actions.articles.bulkUpdateLeft"),{ids:c.value,left:s}).then(()=>{o.success("Статус в левой колонки массово обновлен");const t=[...c.value];c.value=[],M.value.forEach(l=>{t.includes(l.id)&&(l.left=s)})}).catch(()=>{o.error("Не удалось обновить статус в левой колонке")})},H=s=>{if(c.value.length===0){o.warning(`Выберите статьи для ${s?"активации":"деактивации"}.`);return}if(c.value.length===0){o.warning(`Выберите статьи для ${s?"активации в главном":"деактивации в главном"}.`);return}P.put(route("admin.actions.articles.bulkUpdateMain"),{ids:c.value,main:s}).then(()=>{o.success("Статус в главном массово обновлен");const t=[...c.value];c.value=[],M.value.forEach(l=>{t.includes(l.id)&&(l.main=s)})}).catch(()=>{o.error("Не удалось обновить статус в главном")})},K=s=>{if(c.value.length===0){o.warning(`Выберите статьи для ${s?"активации":"деактивации"}.`);return}P.put(route("admin.actions.articles.bulkUpdateRight"),{ids:c.value,right:s}).then(()=>{o.success("Статус в правой колонки массово обновлен");const t=[...c.value];c.value=[],M.value.forEach(l=>{t.includes(l.id)&&(l.right=s)})}).catch(()=>{o.error("Не удалось обновить статус в правой колонке")})},X=()=>{if(c.value.length===0){o.warning("Выберите хотя бы одну статью для удаления.");return}confirm("Вы уверены, что хотите их удалить ?")&&x.delete(route("admin.actions.articles.bulkDestroy"),{data:{ids:c.value},preserveScroll:!0,preserveState:!1,onSuccess:s=>{c.value=[],o.success("Массовое удаление статей успешно завершено.")},onError:s=>{console.error("Ошибка массового удаления:",s);const t=Object.keys(s)[0],l=s[t]||"Произошла ошибка при удалении статей.";o.error(l)}})},Y=s=>{const t=s.target.value;t==="selectAll"?c.value=M.value.map(l=>l.id):t==="deselectAll"?c.value=[]:t==="activate"?j(!0):t==="deactivate"?j(!1):t==="left"?F(!0):t==="noLeft"?F(!1):t==="main"?H(!0):t==="noMain"?H(!1):t==="right"?K(!0):t==="noRight"?K(!1):t==="delete"&&X(),s.target.value=""};return(s,t)=>(m(),z(le,{title:a(g)("posts")},{header:A(()=>[v(ae,null,{default:A(()=>[U(i(a(g)("posts")),1)]),_:1})]),default:A(()=>[e("div",ns,[e("div",cs,[e("div",ds,[v(ie,{href:s.route("admin.articles.create")},{icon:A(()=>[us]),default:A(()=>[U(" "+i(a(g)("addPost")),1)]),_:1},8,["href"]),_.articlesCount?(m(),z(rs,{key:0,onChange:Y})):E("",!0)]),_.articlesCount?(m(),z(de,{key:0,modelValue:L.value,"onUpdate:modelValue":t[0]||(t[0]=l=>L.value=l),placeholder:a(g)("searchByName")},null,8,["modelValue","placeholder"])):E("",!0),_.articlesCount?(m(),z(ne,{key:1},{default:A(()=>[U(i(_.articlesCount),1)]),_:1})):E("",!0),v(Zt,{articles:M.value,"selected-articles":c.value,onToggleLeft:h,onToggleMain:r,onToggleRight:f,onToggleActivity:J,onDelete:T,onClone:Z,onUpdateSortOrder:Q,onToggleSelect:W,onToggleAll:q},null,8,["articles","selected-articles"]),_.articlesCount?(m(),w("div",ps,[v(ue,{"items-per-page":p.value,"onUpdate:itemsPerPage":t[1]||(t[1]=l=>p.value=l)},null,8,["items-per-page"]),v(pe,{"current-page":D.value,"items-per-page":p.value,"total-items":B.value.length,"onUpdate:currentPage":t[2]||(t[2]=l=>D.value=l)},null,8,["current-page","items-per-page","total-items"]),v(Ve,{sortParam:n.value,"onUpdate:sortParam":t[3]||(t[3]=l=>n.value=l)},null,8,["sortParam"])])):E("",!0)])]),v(ce,{show:y.value,onClose:C,onCancel:C,onConfirm:d,cancelText:a(g)("cancel"),confirmText:a(g)("yesDelete")},null,8,["show","cancelText","confirmText"])]),_:1},8,["title"]))}};export{zs as default};
