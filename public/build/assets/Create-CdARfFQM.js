import{y as T,u as z,T as B,l as L,Q as I,e as O,o as A,w as n,f as s,i as a,k as e,p as _,t as d,A as b,q as E}from"./vendor-CMULZhQa.js";import{_ as N,t as S}from"./MetatagsButton-DFHL53iq.js";import{A as q}from"./AdminLayout-BMfLiLo0.js";import{T as D}from"./TitlePage-DOI2IMRH.js";import{_ as V}from"./DefaultButton-CB_WTPCQ.js";import{_ as f,a as g}from"./InputText-BO1leBMl.js";import{_ as u}from"./InputError-B8v-5UJo.js";import{_ as F}from"./PrimaryButton-BQKaB6gG.js";import{_ as H,a as P}from"./TinyEditor-zoGYMinn.js";import{_ as k}from"./MetaDescTextarea-BqXrk_pu.js";import{_ as K,a as Q,b as G}from"./InputNumber-BKnpntqH.js";import{_ as J}from"./SelectParentCategory-BQjkudYj.js";import{_ as R}from"./MultiImageUpload-B1nZ7a18.js";import"./vendor-axios-jn5v1YEJ.js";import"./vendor-lodash-3g6-h99u.js";import"./sidebarIcons-D5nT6JI0.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ResponsiveNavLink-BBt1gw6L.js";import"./ScrollButtons-DjRj6zOj.js";import"./app-BmuzEqX8.js";import"./auth-image-XbvYdkSi.js";const W={class:"px-4 sm:px-6 lg:px-8 py-8 w-full max-w-12xl mx-auto"},X={class:"p-4 bg-slate-50 dark:bg-slate-700 border border-blue-400 dark:border-blue-200 shadow-lg shadow-gray-500 dark:shadow-slate-400 bg-opacity-95 dark:bg-opacity-95"},Y={class:"sm:flex sm:justify-between sm:items-center mb-2"},Z=s("svg",{class:"w-4 h-4 fill-current text-slate-100 shrink-0 mr-2",viewBox:"0 0 16 16"},[s("path",{d:"M4.3 4.5c1.9-1.9 5.1-1.9 7 0 .7.7 1.2 1.7 1.4 2.7l2-.3c-.2-1.5-.9-2.8-1.9-3.8C10.1.4 5.7.4 2.9 3.1L.7.9 0 7.3l6.4-.7-2.1-2.1zM15.6 8.7l-6.4.7 2.1 2.1c-1.9 1.9-5.1 1.9-7 0-.7-.7-1.2-1.7-1.4-2.7l-2 .3c.2 1.5.9 2.8 1.9 3.8 1.4 1.4 3.1 2 4.9 2 1.8 0 3.6-.7 4.9-2l2.2 2.2.8-6.4z"})],-1),ee=s("div",{class:"grid grid-flow-col sm:auto-cols-max justify-start sm:justify-end gap-2"},null,-1),te={class:"mb-3 flex justify-between flex-col lg:flex-row items-center gap-4"},se={class:"flex flex-row items-center gap-2"},le={class:"flex flex-row items-center w-auto"},ae={class:"flex flex-row items-center gap-2"},oe={class:"h-8 flex items-center"},re={class:"mb-3 flex flex-col items-start"},ie={class:"flex justify-between w-full"},me=s("span",{class:"text-red-500 dark:text-red-300 font-semibold"},"*",-1),de={class:"text-md text-gray-900 dark:text-gray-400 mt-1"},ne={class:"mb-3 flex flex-col items-start"},ce=s("span",{class:"text-red-500 dark:text-red-300 font-semibold"},"*",-1),ue={class:"mb-3 flex flex-col items-start"},fe={class:"flex justify-between w-full"},_e={class:"text-md text-gray-900 dark:text-gray-400 mt-1"},pe={class:"mb-3 flex flex-col items-start"},ge={class:"mb-3 flex flex-col items-start"},xe={class:"flex justify-between w-full"},he={class:"text-md text-gray-900 dark:text-gray-400 mt-1"},ve={class:"mb-3 flex flex-col items-start"},ye={class:"flex justify-between w-full"},we={class:"text-md text-gray-900 dark:text-gray-400 mt-1"},be={class:"mb-3 flex flex-col items-start"},Ve={class:"flex justify-between w-full"},ke={class:"text-md text-gray-900 dark:text-gray-400 mt-1"},$e={class:"flex justify-end mt-4"},Me=s("svg",{class:"w-4 h-4 fill-current text-slate-600 shrink-0 mr-2",viewBox:"0 0 16 16"},[s("path",{d:"M13 7h2v6a1 1 0 01-1 1H4v2l-4-3 4-3v2h9V7zM3 9H1V3a1 1 0 011-1h10V0l4 3-4 3V4H3v5z"})],-1),Ue={class:"mt-4"},je={class:"flex items-center justify-center mt-4"},Ce=s("svg",{class:"w-4 h-4 fill-current text-slate-100 shrink-0 mr-2",viewBox:"0 0 16 16"},[s("path",{d:"M4.3 4.5c1.9-1.9 5.1-1.9 7 0 .7.7 1.2 1.7 1.4 2.7l2-.3c-.2-1.5-.9-2.8-1.9-3.8C10.1.4 5.7.4 2.9 3.1L.7.9 0 7.3l6.4-.7-2.1-2.1zM15.6 8.7l-6.4.7 2.1 2.1c-1.9 1.9-5.1 1.9-7 0-.7-.7-1.2-1.7-1.4-2.7l-2 .3c.2 1.5.9 2.8 1.9 3.8 1.4 1.4 3.1 2 4.9 2 1.8 0 3.6-.7 4.9-2l2.2 2.2.8-6.4z"})],-1),Te=s("svg",{class:"w-4 h-4 fill-current text-slate-100",viewBox:"0 0 16 16"},[s("path",{d:"M14.3 2.3L5 11.6 1.7 8.3c-.4-.4-1-.4-1.4 0-.4.4-.4 1 0 1.4l4 4c.2.2.4.3.7.3.3 0 .5-.1.7-.3l10-10c.4-.4.4-1 0-1.4-.4-.4-1-.4-1.4 0z"})],-1),Ze={__name:"Create",props:{images:Array},setup(ze){const v=T(),{t:i}=z(),t=B({parent_id:null,sort:"0",title:"",locale:"",url:"",short:"",description:"",meta_title:"",meta_keywords:"",meta_desc:"",activity:!1,images:[]}),y=L([]),$=r=>{y.value=r},x=I(),M=w(x.props.potentialParents);function w(r,l=null,o=0){let m=[];return r.filter(c=>c.parent_id===l).sort((c,p)=>(c.sort||0)-(p.sort||0)).forEach(c=>{m.push({id:c.id,title:`${"— ".repeat(o)}${c.title}`});const p=w(r,c.id,o+1);m=m.concat(p)}),m}const U=()=>{t.title&&(t.url=S(t.title.toLowerCase()))},h=(r,l,o=!1)=>{if(r.length<=l)return r;const m=r.substr(0,r.lastIndexOf(" ",l));return o?`${m}...`:m},j=()=>{if(t.title&&!t.meta_title&&(t.meta_title=h(t.title,160)),!t.meta_keywords&&t.short){let r=t.short.replace(/(<([^>]+)>)/gi,"");r=r.replace(/[.,!?;:()\[\]{}"'«»]/g,"");const o=r.split(/\s+/).filter(m=>m&&m.length>=3).map(m=>m.toLowerCase()).filter((m,c,p)=>p.indexOf(m)===c).join(", ");t.meta_keywords=h(o,255)}if(t.short&&!t.meta_desc){const r=t.short.replace(/(<([^>]+)>)/gi,"");t.meta_desc=h(r,200,!0)}},C=()=>{t.transform(r=>{const l={...r,activity:r.activity?1:0};return y.value.forEach((o,m)=>{l[`images[${m}][file]`]=o.file,l[`images[${m}][order]`]=o.order??0,l[`images[${m}][alt]`]=o.alt??"",l[`images[${m}][caption]`]=o.caption??""}),l}),t.post(route("admin.categories.store"),{errorBag:"createCategory",preserveScroll:!0,onSuccess:()=>{v.success("Категория успешно создана!")},onError:r=>{console.error("Не удалось отправить форму:",r);const l=r[Object.keys(r)[0]];v.error(l||"Пожалуйста, проверьте правильность заполнения полей.")}})};return(r,l)=>(A(),O(q,{title:e(i)("addCategory")},{header:n(()=>[a(D,null,{default:n(()=>[_(d(e(i)("addCategory")),1)]),_:1})]),default:n(()=>[s("div",W,[s("div",X,[s("div",Y,[a(V,{href:r.route("admin.categories.index",{locale:e(x).props.targetLocale})},{icon:n(()=>[Z]),default:n(()=>[_(" "+d(e(i)("back")),1)]),_:1},8,["href"]),ee]),s("form",{onSubmit:b(C,["prevent"]),enctype:"multipart/form-data",class:"p-3 w-full"},[s("div",te,[s("div",se,[a(K,{modelValue:e(t).activity,"onUpdate:modelValue":l[0]||(l[0]=o=>e(t).activity=o)},null,8,["modelValue"]),a(Q,{for:"activity",text:e(i)("activity"),class:"text-sm h-8 flex items-center"},null,8,["text"])]),s("div",le,[a(H,{modelValue:e(t).locale,"onUpdate:modelValue":l[1]||(l[1]=o=>e(t).locale=o),errorMessage:e(t).errors.locale},null,8,["modelValue","errorMessage"]),a(u,{class:"mt-2 lg:mt-0",message:e(t).errors.locale},null,8,["message"])]),s("div",ae,[s("div",oe,[a(f,{for:"sort",value:e(i)("sort"),class:"text-sm"},null,8,["value"])]),a(G,{id:"sort",type:"number",modelValue:e(t).sort,"onUpdate:modelValue":l[2]||(l[2]=o=>e(t).sort=o),autocomplete:"sort",class:"w-full lg:w-28"},null,8,["modelValue"]),a(u,{class:"mt-2 lg:mt-0",message:e(t).errors.sort},null,8,["message"])])]),a(J,{modelValue:e(t).parent_id,"onUpdate:modelValue":l[3]||(l[3]=o=>e(t).parent_id=o),options:e(M),errorMessage:e(t).errors.parent_id},null,8,["modelValue","options","errorMessage"]),s("div",re,[s("div",ie,[a(f,{for:"title"},{default:n(()=>[me,_(" "+d(e(i)("title")),1)]),_:1}),s("div",de,d(e(t).title.length)+" / 100 "+d(e(i)("characters")),1)]),a(g,{id:"title",type:"text",modelValue:e(t).title,"onUpdate:modelValue":l[4]||(l[4]=o=>e(t).title=o),maxlength:"100",required:"",autocomplete:"title"},null,8,["modelValue"]),a(u,{class:"mt-2",message:e(t).errors.title},null,8,["message"])]),s("div",ne,[a(f,{for:"url"},{default:n(()=>[ce,_(" "+d(e(i)("url")),1)]),_:1}),a(g,{id:"url",type:"text",modelValue:e(t).url,"onUpdate:modelValue":l[5]||(l[5]=o=>e(t).url=o),required:"",autocomplete:"url",onFocus:U},null,8,["modelValue"]),a(u,{class:"mt-2",message:e(t).errors.url},null,8,["message"])]),s("div",ue,[s("div",fe,[a(f,{for:"short",value:e(i)("shortDescription")},null,8,["value"]),s("div",_e,d(e(t).short.length)+" / 255 "+d(e(i)("characters")),1)]),a(k,{modelValue:e(t).short,"onUpdate:modelValue":l[6]||(l[6]=o=>e(t).short=o),class:"w-full"},null,8,["modelValue"]),a(u,{class:"mt-2",message:e(t).errors.short},null,8,["message"])]),s("div",pe,[a(f,{for:"description",value:e(i)("description")},null,8,["value"]),a(P,{modelValue:e(t).description,"onUpdate:modelValue":l[7]||(l[7]=o=>e(t).description=o),height:500},null,8,["modelValue"]),a(u,{class:"mt-2",message:e(t).errors.description},null,8,["message"])]),s("div",ge,[s("div",xe,[a(f,{for:"meta_title",value:e(i)("metaTitle")},null,8,["value"]),s("div",he,d(e(t).meta_title.length)+" / 160 "+d(e(i)("characters")),1)]),a(g,{id:"meta_title",type:"text",modelValue:e(t).meta_title,"onUpdate:modelValue":l[8]||(l[8]=o=>e(t).meta_title=o),maxlength:"160",autocomplete:"url"},null,8,["modelValue"]),a(u,{class:"mt-2",message:e(t).errors.meta_title},null,8,["message"])]),s("div",ve,[s("div",ye,[a(f,{for:"meta_keywords",value:e(i)("metaKeywords")},null,8,["value"]),s("div",we,d(e(t).meta_keywords.length)+" / 255 "+d(e(i)("characters")),1)]),a(g,{id:"meta_keywords",type:"text",modelValue:e(t).meta_keywords,"onUpdate:modelValue":l[9]||(l[9]=o=>e(t).meta_keywords=o),maxlength:"255",autocomplete:"url"},null,8,["modelValue"]),a(u,{class:"mt-2",message:e(t).errors.meta_keywords},null,8,["message"])]),s("div",be,[s("div",Ve,[a(f,{for:"meta_desc",value:e(i)("metaDescription")},null,8,["value"]),s("div",ke,d(e(t).meta_desc.length)+" / 200 "+d(e(i)("characters")),1)]),a(k,{modelValue:e(t).meta_desc,"onUpdate:modelValue":l[10]||(l[10]=o=>e(t).meta_desc=o),maxlength:"200",class:"w-full"},null,8,["modelValue"]),a(u,{class:"mt-2",message:e(t).errors.meta_desc},null,8,["message"])]),s("div",$e,[a(N,{onClick:b(j,["prevent"])},{icon:n(()=>[Me]),default:n(()=>[_(" "+d(e(i)("generateMetaTags")),1)]),_:1})]),s("div",Ue,[a(R,{"onUpdate:images":$})]),s("div",je,[a(V,{href:r.route("admin.categories.index",{locale:e(x).props.targetLocale}),class:"mb-3"},{icon:n(()=>[Ce]),default:n(()=>[_(" "+d(e(i)("back")),1)]),_:1},8,["href"]),a(F,{class:E(["ms-4 mb-0",{"opacity-25":e(t).processing}]),disabled:e(t).processing},{icon:n(()=>[Te]),default:n(()=>[_(" "+d(e(i)("save")),1)]),_:1},8,["class","disabled"])])],32)])])]),_:1},8,["title"]))}};export{Ze as default};
