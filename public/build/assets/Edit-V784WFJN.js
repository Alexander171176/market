import{y as E,u as L,T as P,l as b,e as q,o as H,w as c,f as a,i as l,p,t as m,k as e,A as k,B as U,q as N}from"./vendor-CMULZhQa.js";import{_ as O,t as S}from"./MetatagsButton-DFHL53iq.js";import{A as K}from"./AdminLayout-BMfLiLo0.js";import{T as G}from"./TitlePage-DOI2IMRH.js";import{_ as $}from"./DefaultButton-CB_WTPCQ.js";import{_ as J}from"./PrimaryButton-BQKaB6gG.js";import{_ as Q}from"./ClearMetaButton-BG4n4BXu.js";import{_ as x,a as g,b as R}from"./InputNumber-BKnpntqH.js";import{_ as W,a as X}from"./TinyEditor-zoGYMinn.js";import{_ as M}from"./MetaDescTextarea-BqXrk_pu.js";import{_ as n,a as h}from"./InputText-BO1leBMl.js";import{_ as u}from"./InputError-B8v-5UJo.js";import{_ as Y}from"./MultiImageUpload-B1nZ7a18.js";import{_ as Z}from"./MultiImageEdit-BcZmVenZ.js";/* empty css                                                                     */import"./vendor-axios-jn5v1YEJ.js";import"./vendor-lodash-3g6-h99u.js";import"./sidebarIcons-D5nT6JI0.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ResponsiveNavLink-BBt1gw6L.js";import"./ScrollButtons-DjRj6zOj.js";import"./app-BmuzEqX8.js";import"./auth-image-XbvYdkSi.js";const ee={class:"px-4 sm:px-6 lg:px-8 py-8 w-full max-w-12xl mx-auto"},te={class:"p-4 bg-slate-50 dark:bg-slate-700 border border-blue-400 dark:border-blue-200 shadow-lg shadow-gray-500 dark:shadow-slate-400 bg-opacity-95 dark:bg-opacity-95"},se={class:"sm:flex sm:justify-between sm:items-center mb-2"},le=a("svg",{class:"w-4 h-4 fill-current text-slate-100 shrink-0 mr-2",viewBox:"0 0 16 16"},[a("path",{d:"M4.3 4.5c1.9-1.9 5.1-1.9 7 0 .7.7 1.2 1.7 1.4 2.7l2-.3c-.2-1.5-.9-2.8-1.9-3.8C10.1.4 5.7.4 2.9 3.1L.7.9 0 7.3l6.4-.7-2.1-2.1zM15.6 8.7l-6.4.7 2.1 2.1c-1.9 1.9-5.1 1.9-7 0-.7-.7-1.2-1.7-1.4-2.7l-2 .3c.2 1.5.9 2.8 1.9 3.8 1.4 1.4 3.1 2 4.9 2 1.8 0 3.6-.7 4.9-2l2.2 2.2.8-6.4z"})],-1),ae=a("div",{class:"grid grid-flow-col sm:auto-cols-max justify-start sm:justify-end gap-2"},null,-1),oe={class:"mb-3 flex justify-between flex-col lg:flex-row items-center gap-4"},re={class:"flex flex-row items-center gap-2"},ie={class:"flex flex-row items-center gap-2 w-auto"},de={class:"flex flex-row items-center gap-2"},me={class:"h-8 flex items-center"},ce={class:"mb-3 flex justify-between flex-col lg:flex-row items-center gap-4"},ne={class:"flex flex-row items-center gap-2"},ue={class:"flex flex-row items-center gap-2"},fe={class:"flex flex-row items-center gap-2"},pe={class:"mb-3 flex flex-col items-start"},_e={class:"mb-3 flex flex-col items-start"},xe=a("span",{class:"text-red-500 dark:text-red-300 font-semibold"},"*",-1),ge={class:"mb-3 flex flex-col items-start"},he=a("span",{class:"text-red-500 dark:text-red-300 font-semibold"},"*",-1),ve={class:"mb-3 flex flex-col items-start"},we={class:"flex justify-between w-full"},ye={class:"text-md text-gray-900 dark:text-gray-400 mt-1"},Ve={class:"mb-3 flex flex-col items-start"},be={class:"mb-3 flex flex-col items-start"},ke={class:"mb-3 flex flex-col items-start"},Ue={class:"flex justify-between w-full"},$e={class:"text-md text-gray-900 dark:text-gray-400 mt-1"},Me={class:"mb-3 flex flex-col items-start"},je={class:"flex justify-between w-full"},Be={class:"text-md text-gray-900 dark:text-gray-400 mt-1"},Ie={class:"mb-3 flex flex-col items-start"},ze={class:"flex justify-between w-full"},Te={class:"text-md text-gray-900 dark:text-gray-400 mt-1"},Ce={class:"flex justify-end mt-4"},Fe=a("svg",{class:"w-4 h-4 fill-current text-gray-500 shrink-0 mr-2",viewBox:"0 0 16 16"},[a("path",{d:"M8 0C3.58 0 0 3.58 0 8s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm3 9H5V7h6v2z"})],-1),De=a("svg",{class:"w-4 h-4 fill-current text-slate-600 shrink-0 mr-2",viewBox:"0 0 16 16"},[a("path",{d:"M13 7h2v6a1 1 0 01-1 1H4v2l-4-3 4-3v2h9V7zM3 9H1V3a1 1 0 011-1h10V0l4 3-4 3V4H3v5z"})],-1),Ae={class:"mt-4"},Ee={class:"mt-4"},Le={class:"flex items-center justify-center mt-4"},Pe=a("svg",{class:"w-4 h-4 fill-current text-slate-100 shrink-0 mr-2",viewBox:"0 0 16 16"},[a("path",{d:"M4.3 4.5c1.9-1.9 5.1-1.9 7 0 .7.7 1.2 1.7 1.4 2.7l2-.3c-.2-1.5-.9-2.8-1.9-3.8C10.1.4 5.7.4 2.9 3.1L.7.9 0 7.3l6.4-.7-2.1-2.1zM15.6 8.7l-6.4.7 2.1 2.1c-1.9 1.9-5.1 1.9-7 0-.7-.7-1.2-1.7-1.4-2.7l-2 .3c-.2 1.5.9 2.8 1.9 3.8 1.4 1.4 3.1 2 4.9 2 1.8 0 3.6-.7 4.9-2l2.2 2.2 .8-6.4z"})],-1),qe=a("svg",{class:"w-4 h-4 fill-current text-slate-100",viewBox:"0 0 16 16"},[a("path",{d:"M14.3 2.3L5 11.6 1.7 8.3c-.4-.4-1-.4-1.4 0-.4.4-.4 1 0 1.4l4 4c.2.2.4.3.7.3.3 0 .5-.1.7-.3l10-10c.4-.4.4-1 0-1.4-.4-.4-1-.4-1.4 0z"})],-1),ct={__name:"Edit",props:{product:{type:Object,required:!0},categories:Array,related_products:{type:Array,default:()=>[]}},setup(v){const y=E(),{t:i}=L(),d=v,t=P({_method:"PUT",sort:d.product.sort??0,locale:d.product.locale??"",title:d.product.title??"",url:d.product.url??"",short:d.product.short??"",description:d.product.description??"",meta_title:d.product.meta_title??"",meta_keywords:d.product.meta_keywords??"",meta_desc:d.product.meta_desc??"",activity:!!d.product.activity,left:!!d.product.left,main:!!d.product.main,right:!!d.product.right,categories:d.product.categories??[],related_products:d.product.related_products??[],deletedImages:[]}),_=b((d.product.images||[]).filter(o=>o.url).map(o=>({id:o.id,url:o.webp_url||o.url,order:o.order||0,alt:o.alt||"",caption:o.caption||""}))),V=b([]),j=o=>{_.value=o},B=o=>{t.deletedImages.includes(o)||t.deletedImages.push(o),_.value=_.value.filter(s=>s.id!==o)},I=o=>{V.value=o},z=()=>{t.title&&(t.url=S(t.title.toLowerCase()))},w=(o,s,r=!1)=>{if(o.length<=s)return o;const f=o.substr(0,o.lastIndexOf(" ",s));return r?`${f}...`:f},T=()=>{t.meta_title="",t.meta_keywords="",t.meta_desc=""},C=()=>{if(t.title&&!t.meta_title&&(t.meta_title=w(t.title,160)),!t.meta_keywords&&t.short){let o=t.short.replace(/(<([^>]+)>)/gi,"");o=o.replace(/[.,!?;:()\[\]{}"'«»]/g,"");const r=o.split(/\s+/).filter(f=>f&&f.length>=3).map(f=>f.toLowerCase()).filter((f,D,A)=>A.indexOf(f)===D).join(", ");t.meta_keywords=w(r,255)}if(t.short&&!t.meta_desc){const o=t.short.replace(/(<([^>]+)>)/gi,"");t.meta_desc=w(o,200,!0)}},F=()=>{t.transform(o=>({...o,activity:o.activity?1:0,left:o.left?1:0,main:o.main?1:0,right:o.right?1:0,images:[...V.value.map(s=>({file:s.file,order:s.order,alt:s.alt,caption:s.caption})),..._.value.map(s=>({id:s.id,order:s.order,alt:s.alt,caption:s.caption}))],deletedImages:t.deletedImages})),t.post(route("admin.products.update",d.product.id),{preserveScroll:!0,forceFormData:!0,onSuccess:o=>{y.success("Товар успешно обновлен!")},onError:o=>{console.error("❌ Ошибка при обновлении товара:",o);const s=o[Object.keys(o)[0]];y.error(s||"Пожалуйста, проверьте правильность заполнения полей.")}})};return(o,s)=>(H(),q(K,{title:e(i)("editProduct")},{header:c(()=>[l(G,null,{default:c(()=>[p(m(e(i)("editProduct"))+": "+m(d.product.title),1)]),_:1})]),default:c(()=>[a("div",ee,[a("div",te,[a("div",se,[l($,{href:o.route("admin.products.index")},{icon:c(()=>[le]),default:c(()=>[p(" "+m(e(i)("back")),1)]),_:1},8,["href"]),ae]),a("form",{onSubmit:k(F,["prevent"]),enctype:"multipart/form-data",class:"p-3 w-full"},[a("div",oe,[a("div",re,[l(x,{modelValue:e(t).activity,"onUpdate:modelValue":s[0]||(s[0]=r=>e(t).activity=r)},null,8,["modelValue"]),l(g,{for:"activity",text:e(i)("activity"),class:"text-sm h-8 flex items-center"},null,8,["text"])]),a("div",ie,[l(W,{modelValue:e(t).locale,"onUpdate:modelValue":s[1]||(s[1]=r=>e(t).locale=r),errorMessage:e(t).errors.locale},null,8,["modelValue","errorMessage"]),l(u,{class:"mt-2 lg:mt-0",message:e(t).errors.locale},null,8,["message"])]),a("div",de,[a("div",me,[l(n,{for:"sort",value:e(i)("sort"),class:"text-sm"},null,8,["value"])]),l(R,{id:"sort",type:"number",modelValue:e(t).sort,"onUpdate:modelValue":s[2]||(s[2]=r=>e(t).sort=r),autocomplete:"sort",class:"w-full lg:w-28"},null,8,["modelValue"]),l(u,{class:"mt-2 lg:mt-0",message:e(t).errors.sort},null,8,["message"])])]),a("div",ce,[a("div",ne,[l(x,{modelValue:e(t).left,"onUpdate:modelValue":s[3]||(s[3]=r=>e(t).left=r)},null,8,["modelValue"]),l(g,{for:"left",text:e(i)("left"),class:"text-sm h-8 flex items-center"},null,8,["text"])]),a("div",ue,[l(x,{modelValue:e(t).main,"onUpdate:modelValue":s[4]||(s[4]=r=>e(t).main=r)},null,8,["modelValue"]),l(g,{for:"main",text:e(i)("main"),class:"text-sm h-8 flex items-center"},null,8,["text"])]),a("div",fe,[l(x,{modelValue:e(t).right,"onUpdate:modelValue":s[5]||(s[5]=r=>e(t).right=r)},null,8,["modelValue"]),l(g,{for:"right",text:e(i)("right"),class:"text-sm h-8 flex items-center"},null,8,["text"])])]),a("div",pe,[l(n,{for:"categories",value:e(i)("categories"),class:"mb-1"},null,8,["value"]),l(e(U),{modelValue:e(t).categories,"onUpdate:modelValue":s[6]||(s[6]=r=>e(t).categories=r),options:v.categories,multiple:!0,"close-on-select":!0,placeholder:e(i)("select"),label:"title","track-by":"title"},null,8,["modelValue","options","placeholder"])]),a("div",_e,[l(n,{for:"title"},{default:c(()=>[xe,p(" "+m(e(i)("name")),1)]),_:1}),l(h,{id:"title",type:"text",modelValue:e(t).title,"onUpdate:modelValue":s[7]||(s[7]=r=>e(t).title=r),required:"",autocomplete:"title"},null,8,["modelValue"]),l(u,{class:"mt-2",message:e(t).errors.title},null,8,["message"])]),a("div",ge,[l(n,{for:"url"},{default:c(()=>[he,p(" "+m(e(i)("url")),1)]),_:1}),l(h,{id:"url",type:"text",modelValue:e(t).url,"onUpdate:modelValue":s[8]||(s[8]=r=>e(t).url=r),required:"",autocomplete:"url",onFocus:z},null,8,["modelValue"]),l(u,{class:"mt-2",message:e(t).errors.url},null,8,["message"])]),a("div",ve,[a("div",we,[l(n,{for:"short",value:e(i)("shortDescription")},null,8,["value"]),a("div",ye,m(e(t).short.length)+" / 255 "+m(e(i)("characters")),1)]),l(M,{modelValue:e(t).short,"onUpdate:modelValue":s[9]||(s[9]=r=>e(t).short=r),class:"w-full"},null,8,["modelValue"]),l(u,{class:"mt-2",message:e(t).errors.short},null,8,["message"])]),a("div",Ve,[l(n,{for:"description",value:e(i)("description")},null,8,["value"]),l(X,{modelValue:e(t).description,"onUpdate:modelValue":s[10]||(s[10]=r=>e(t).description=r),height:500},null,8,["modelValue"]),l(u,{class:"mt-2",message:e(t).errors.description},null,8,["message"])]),a("div",be,[l(n,{for:"related_products",value:e(i)("relatedProducts"),class:"mb-1"},null,8,["value"]),l(e(U),{modelValue:e(t).related_products,"onUpdate:modelValue":s[11]||(s[11]=r=>e(t).related_products=r),options:v.related_products,multiple:!0,"close-on-select":!0,placeholder:e(i)("select"),label:"title","track-by":"title"},null,8,["modelValue","options","placeholder"]),l(u,{class:"mt-2",message:e(t).errors.related_products},null,8,["message"])]),a("div",ke,[a("div",Ue,[l(n,{for:"meta_title",value:e(i)("metaTitle")},null,8,["value"]),a("div",$e,m(e(t).meta_title.length)+" / 160 "+m(e(i)("characters")),1)]),l(h,{id:"meta_title",type:"text",modelValue:e(t).meta_title,"onUpdate:modelValue":s[12]||(s[12]=r=>e(t).meta_title=r),maxlength:"160",autocomplete:"url"},null,8,["modelValue"]),l(u,{class:"mt-2",message:e(t).errors.meta_title},null,8,["message"])]),a("div",Me,[a("div",je,[l(n,{for:"meta_keywords",value:e(i)("metaKeywords")},null,8,["value"]),a("div",Be,m(e(t).meta_keywords.length)+" / 255 "+m(e(i)("characters")),1)]),l(h,{id:"meta_keywords",type:"text",modelValue:e(t).meta_keywords,"onUpdate:modelValue":s[13]||(s[13]=r=>e(t).meta_keywords=r),maxlength:"255",autocomplete:"url"},null,8,["modelValue"]),l(u,{class:"mt-2",message:e(t).errors.meta_keywords},null,8,["message"])]),a("div",Ie,[a("div",ze,[l(n,{for:"meta_desc",value:e(i)("metaDescription")},null,8,["value"]),a("div",Te,m(e(t).meta_desc.length)+" / 200 "+m(e(i)("characters")),1)]),l(M,{modelValue:e(t).meta_desc,"onUpdate:modelValue":s[14]||(s[14]=r=>e(t).meta_desc=r),maxlength:"200",class:"w-full"},null,8,["modelValue"]),l(u,{class:"mt-2",message:e(t).errors.meta_desc},null,8,["message"])]),a("div",Ce,[l(Q,{onClear:T,class:"mr-4"},{default:c(()=>[Fe,p(" "+m(e(i)("clearMetaFields")),1)]),_:1}),l(O,{onClick:k(C,["prevent"])},{icon:c(()=>[De]),default:c(()=>[p(" "+m(e(i)("generateMetaTags")),1)]),_:1})]),a("div",Ae,[l(Z,{images:_.value,"onUpdate:images":j,onDeleteImage:B},null,8,["images"])]),a("div",Ee,[l(Y,{"onUpdate:images":I})]),a("div",Le,[l($,{href:o.route("admin.products.index"),class:"mb-3"},{icon:c(()=>[Pe]),default:c(()=>[p(" "+m(e(i)("back")),1)]),_:1},8,["href"]),l(J,{class:N(["ms-4 mb-0",{"opacity-25":e(t).processing}]),disabled:e(t).processing},{icon:c(()=>[qe]),default:c(()=>[p(" "+m(e(i)("save")),1)]),_:1},8,["disabled","class"])])],32)])])]),_:1},8,["title"]))}};export{ct as default};
