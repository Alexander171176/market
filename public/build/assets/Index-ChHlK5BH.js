import{u as S,m as u,o as i,f as t,t as l,k as n,F as U,v as T,n as w,i as _,y as I,l as v,C as A,E as C,G as P,e as D,w as y,p as E}from"./vendor-BEBDZ0sp.js";import{A as F}from"./AdminLayout-a8zW5zcv.js";import{T as M}from"./TitlePage-DJKfB1_5.js";import{_ as O,a as G,b as Q}from"./CountTable-XEwDSe2k.js";import{_ as q,a as z,b as H}from"./SearchInput-TuOF_y9b.js";import{_ as J}from"./IconEdit-DzaKHCZk.js";import"./vendor-axios-jn5v1YEJ.js";import"./vendor-lodash-CeR_jfIo.js";import"./ScrollButtons-BQPx4wk5.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ResponsiveNavLink-fXlkiuVz.js";import"./LocaleSelectOption-ZRQdJWBb.js";import"./app-aVEG2Way.js";import"./auth-image-XbvYdkSi.js";const K={class:"bg-white dark:bg-slate-700 shadow-lg rounded-sm border border-slate-200 dark:border-slate-600 relative"},R={class:"overflow-x-auto"},W={key:0,class:"table-auto w-full text-slate-700 dark:text-slate-100"},X={class:"text-sm font-semibold uppercase bg-slate-200 dark:bg-cyan-900 border border-solid border-gray-300 dark:border-gray-700"},Y={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},Z={class:"font-semibold text-left"},ee={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},te={class:"font-semibold text-left"},se={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},ae={class:"font-semibold text-left"},re={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},oe={class:"font-semibold text-end"},le={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap text-teal-600 dark:text-violet-200 hover:bg-slate-100 dark:hover:bg-cyan-800"},ne={class:"text-left"},ie={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap text-blue-600 dark:text-blue-200 hover:bg-slate-100 dark:hover:bg-cyan-800"},de={class:"text-left"},ce={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},ue={class:"flex flex-wrap gap-1"},me={key:0,class:"text-xs italic text-gray-500"},pe={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},fe={class:"flex justify-end space-x-2"},_e={key:1,class:"p-5 text-center text-slate-700 dark:text-slate-100"},ve={__name:"UserTable",props:{users:Array},emits:["edit","delete"],setup(c,{emit:m}){const{t:o}=S();return(p,d)=>(i(),u("div",K,[t("div",R,[c.users.length>0?(i(),u("table",W,[t("thead",X,[t("tr",null,[t("th",Y,[t("div",Z,l(n(o)("name")),1)]),t("th",ee,[t("div",te,l(n(o)("email")),1)]),t("th",se,[t("div",ae,l(n(o)("roles")),1)]),t("th",re,[t("div",oe,l(n(o)("actions")),1)])])]),t("tbody",null,[(i(!0),u(U,null,T(c.users,r=>(i(),u("tr",{key:r.id,class:"text-sm font-semibold border-b-2"},[t("td",le,[t("div",ne,l(r.name),1)]),t("td",ie,[t("div",de,l(r.email),1)]),t("td",ce,[t("div",ue,[(i(!0),u(U,null,T(r.roles,f=>(i(),u("span",{key:f.id,class:"px-1 py-0 bg-slate-100 dark:bg-slate-800 border border-dashed border-gray-400 text-orange-500 dark:text-orange-200 text-xs"},l(f.name),1))),128)),r.roles.length===0?(i(),u("span",me," — ")):w("",!0)])]),t("td",pe,[t("div",fe,[_(J,{href:p.route("admin.users.edit",r.id)},null,8,["href"]),_(O,{onDelete:f=>p.$emit("delete",r.id)},null,8,["onDelete"])])])]))),128))])])):(i(),u("div",_e,l(n(o)("noData")),1))])]))}},he={class:"flex justify-center items-center h-fit sm:mr-4 mt-2 mb-2"},xe={for:"sortParam",class:"hidden lg:block sm:mr-2 tracking-wider text-sm font-semibold text-slate-600 dark:text-slate-100"},ge=["value"],be={value:"idDesc"},ye={value:"idAsc"},we={value:"name"},ke={__name:"SortSelect",props:{sortParam:String},emits:["update:sortParam"],setup(c,{emit:m}){const{t:o}=S(),p=m,d=r=>{p("update:sortParam",r.target.value)};return(r,f)=>(i(),u("div",he,[t("label",xe,l(n(o)("sort")),1),t("select",{id:"sortParam",value:c.sortParam,onChange:d,class:"w-44 px-3 py-0.5 form-select bg-white dark:bg-gray-200 text-gray-600 dark:text-gray-900 border border-slate-400 dark:border-slate-600 rounded-sm shadow-sm"},[t("option",be,l(n(o)("idDesc")),1),t("option",ye,l(n(o)("idAsc")),1),t("option",we,l(n(o)("name")),1)],40,ge)]))}},$e={class:"px-4 sm:px-6 lg:px-8 py-8 w-full max-w-12xl mx-auto"},Ce={class:"p-4 bg-slate-50 dark:bg-slate-700 border border-blue-400 dark:border-blue-200 overflow-hidden shadow-lg shadow-gray-500 dark:shadow-slate-400 bg-opacity-95 dark:bg-opacity-95"},Pe=t("div",{class:"sm:flex sm:justify-between sm:items-center mb-2"},null,-1),De={key:2,class:"flex justify-between items-center flex-col md:flex-row my-1"},Ge={__name:"Index",props:["users","usersCount","adminCountUsers","adminSortUsers"],setup(c){const{t:m}=S(),o=I(),p=c,d=v(p.adminCountUsers);A(d,s=>{C.put(route("admin.settings.updateAdminCountUsers"),{value:s},{preserveScroll:!0,preserveState:!0,onSuccess:()=>o.info(`Показ ${s} элементов на странице.`),onError:e=>o.error(e.value||"Ошибка обновления кол-ва элементов.")})});const r=v(p.adminSortUsers);A(r,s=>{C.put(route("admin.settings.updateAdminSortUsers"),{value:s},{preserveScroll:!0,preserveState:!0,onSuccess:()=>o.info("Сортировка успешно изменена"),onError:e=>o.error(e.value||"Ошибка обновления сортировки.")})});const f=v(!1),h=v(null),g=v(""),L=(s,e)=>{h.value=s,g.value=e,f.value=!0},b=()=>{f.value=!1,h.value=null,g.value=""},N=()=>{if(h.value===null)return;const s=h.value,e=g.value;C.delete(route("admin.users.destroy",{user:s}),{preserveScroll:!0,preserveState:!1,onSuccess:a=>{b(),o.success(`Пользователь "${e||"ID: "+s}" удален.`)},onError:a=>{b();const B=a.general||a[Object.keys(a)[0]]||"Произошла ошибка при удалении.";o.error(`${B} (Статья: ${e||"ID: "+s})`),console.error("Ошибка удаления:",a)},onFinish:()=>{h.value=null,g.value=""}})},k=v(1),x=v(""),V=s=>r.value==="idAsc"?s.slice().sort((e,a)=>e.id-a.id):r.value==="idDesc"?s.slice().sort((e,a)=>a.id-e.id):s.slice().sort((e,a)=>e[r.value]<a[r.value]?-1:e[r.value]>a[r.value]?1:0),$=P(()=>{let s=p.users;return x.value&&(s=s.filter(e=>e.name.toLowerCase().includes(x.value.toLowerCase())||e.email.toLowerCase().includes(x.value.toLowerCase()))),V(s)}),j=P(()=>{const s=(k.value-1)*d.value;return $.value.slice(s,s+d.value)});return P(()=>Math.ceil($.value.length/d.value)),(s,e)=>(i(),D(F,{title:n(m)("users")},{header:y(()=>[_(M,null,{default:y(()=>[E(l(n(m)("users")),1)]),_:1})]),default:y(()=>[t("div",$e,[t("div",Ce,[Pe,c.usersCount?(i(),D(q,{key:0,modelValue:x.value,"onUpdate:modelValue":e[0]||(e[0]=a=>x.value=a),placeholder:n(m)("searchByNameOrEmail")},null,8,["modelValue","placeholder"])):w("",!0),c.usersCount?(i(),D(G,{key:1},{default:y(()=>[E(l(c.usersCount),1)]),_:1})):w("",!0),_(ve,{users:j.value,onDelete:L},null,8,["users"]),c.usersCount?(i(),u("div",De,[_(z,{"items-per-page":d.value,"onUpdate:itemsPerPage":e[1]||(e[1]=a=>d.value=a)},null,8,["items-per-page"]),_(H,{"current-page":k.value,"items-per-page":d.value,"total-items":$.value.length,"onUpdate:currentPage":e[2]||(e[2]=a=>k.value=a),"onUpdate:itemsPerPage":e[3]||(e[3]=a=>d.value=a)},null,8,["current-page","items-per-page","total-items"]),_(ke,{sortParam:r.value,"onUpdate:sortParam":e[4]||(e[4]=a=>r.value=a)},null,8,["sortParam"])])):w("",!0)])]),_(Q,{show:f.value,onClose:b,onCancel:b,onConfirm:N,cancelText:n(m)("cancel"),confirmText:n(m)("yesDelete")},null,8,["show","cancelText","confirmText"])]),_:1},8,["title"]))}};export{Ge as default};
