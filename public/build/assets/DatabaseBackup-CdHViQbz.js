import{u as B,y as V,l as h,z,e as C,o as n,w as m,f as e,m as u,n as H,p as k,t as i,k as s,K as S,F,v as M,i as D,E as _}from"./vendor-BxBIhlnJ.js";import{a as p}from"./vendor-axios-jn5v1YEJ.js";import{A as T}from"./AdminLayout-CVVbnZvQ.js";import{T as j}from"./TitlePage-DSlumAVb.js";import"./vendor-lodash-BkjH9gY7.js";import"./ScrollButtons-cQZjvK3h.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ResponsiveNavLink-De0bHo2I.js";import"./LocaleSelectOption-C-FbJBp9.js";import"./app-T6LOBsMh.js";import"./auth-image-XbvYdkSi.js";const E={class:"px-4 sm:px-6 lg:px-8 py-8 w-full max-w-12xl mx-auto"},N={class:"p-4 bg-slate-50 dark:bg-slate-700 border border-blue-400 dark:border-blue-200 overflow-hidden shadow-lg shadow-gray-500 dark:shadow-slate-400 bg-opacity-95 dark:bg-opacity-95"},L={class:"sm:flex sm:justify-between sm:items-center mb-4"},R=["disabled"],$=e("svg",{class:"w-4 h-4 fill-current opacity-50 shrink-0 mr-1",viewBox:"0 0 16 16"},[e("path",{d:"M15 7H9V1c0-.6-.4-1-1-1S7 .4 7 1v6H1c-.6 0-1 .4-1 1s.4 1 1 1h6v6c0 .6.4 1 1 1s1-.4 1-1V9h6c.6 0 1-.4 1-1s-.4-1-1-1z"})],-1),A={key:0,class:"mb-4 w-full"},K={class:"text-sm font-medium text-blue-700 dark:text-blue-200 mb-1"},P={class:"w-full h-3 bg-gray-300 dark:bg-gray-600 rounded-full overflow-hidden"},I={class:"mt-6"},q={class:"text-slate-700 dark:text-slate-200 text-center text-md font-semibold mb-2"},G={key:0,class:"text-gray-500 text-center"},J={key:1,class:"divide-y border rounded"},O={class:"font-medium text-sm text-amber-700 dark:text-amber-200"},Q={class:"text-xs text-gray-500 dark:text-gray-400"},U={class:"flex items-center space-x-2"},W=["href","title"],X=e("svg",{class:"w-6 h-6 fill-current",viewBox:"0 0 24 24"},[e("path",{d:"M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7z"})],-1),Y=[X],Z=["title","onClick","disabled"],ee=e("svg",{class:"w-4 h-4 fill-current",viewBox:"0 0 24 24"},[e("path",{d:"M12,10C8.2,10,4.3,9.3,2,7.6V12c0,2.7,5.2,4,10,4s10-1.3,10-4V7.6C19.7,9.3,15.8,10,12,10z"}),e("path",{d:"M12,18c-3.8,0-7.7-0.7-10-2.4V20c0,2.7,5.2,4,10,4s10-1.3,10-4v-4.4C19.7,17.3,15.8,18,12,18z"}),e("path",{d:"M12,0C7.2,0,2,1.3,2,4s5.2,4,10,4s10-1.3,10-4S16.8,0,12,0z"})],-1),te=[ee],ae=["title","onClick","disabled"],se=e("svg",{class:"w-4 h-4 fill-current",viewBox:"0 0 16 16"},[e("path",{d:"M5 7h2v6H5V7zm4 0h2v6H9V7zm3-6v2h4v2h-1v10c0 .6-.4 1-1 1H2c-.6 0-1-.4-1-1V5H0V3h4V1c0-.6.4-1 1-1h6c.6 0 1 .4 1 1zM6 2v1h4V2H6zm7 3H3v9h10V5z"})],-1),re=[se],ke={__name:"DatabaseBackup",setup(oe){const{t}=B(),d=V(),b=h([]),r=h(!1),o=h(0),a=h(0),v=async()=>{try{const l=await p.get(route("admin.backup.list"));b.value=l.data.backups}catch{d.error(t("failedToLoadBackups"))}},f=async()=>{r.value=!0,a.value=20;try{await p.post(route("admin.backup.create")),a.value=100,d.success(t("backupCreated")),await v()}catch{d.error(t("backupFailed"))}finally{setTimeout(()=>{a.value=0,r.value=!1},1e3)}},g=async l=>{if(l){r.value=!0,o.value=1,a.value=33;try{await p.post(route("admin.backup.create")),o.value=2,a.value=66,await _.post(route("admin.backup.restore"),{file:l},{preserveScroll:!0,onSuccess:()=>{o.value=3,a.value=100,d.success(t("backupRestored")),v(),setTimeout(()=>{o.value=0,a.value=0},3e3)},onError:()=>{d.error(t("backupRestoreFailed")),o.value=0,a.value=0},onFinish:()=>{r.value=!1}})}catch{d.error(t("backupFailed")),r.value=!1,o.value=0,a.value=0}}},x=l=>{!l||!confirm(t("backupConfirmDeleteBackup"))||(r.value=!0,_.delete(route("admin.backup.delete"),{data:{file:l},preserveScroll:!0,onFinish:()=>r.value=!1,onSuccess:()=>{d.success(t("backupDeleted")),v()},onError:()=>d.error(t("backupDeleteFailed"))}))};return z(v),(l,y)=>(n(),C(T,{title:s(t)("databaseBackup")},{header:m(()=>[D(j,null,{default:m(()=>[k(i(s(t)("databaseBackup")),1)]),_:1})]),default:m(()=>[e("div",E,[e("div",N,[e("div",L,[e("button",{onClick:f,disabled:r.value,class:"flex items-center btn px-2 py-0.5 bg-sky-600 text-white text-sm font-semibold rounded-sm shadow-md transition-colors duration-300 ease-in-out hover:bg-sky-700 focus:bg-sky-700 focus:outline-none"},[$,k(" "+i(s(t)("createBackup")),1)],8,R)]),o.value>0||a.value>0?(n(),u("div",A,[e("div",K,i(o.value===1?s(t)("backupStep1"):o.value===2?s(t)("backupStep2"):o.value===3?s(t)("backupStep3"):a.value>0?s(t)("creatingBackup"):""),1),e("div",P,[e("div",{class:"h-full bg-blue-600 transition-all duration-500",style:S({width:`${a.value}%`})},null,4)])])):H("",!0),e("div",I,[e("h2",q,i(s(t)("availableBackups")),1),b.value.length===0?(n(),u("div",G,i(s(t)("noData")),1)):(n(),u("ul",J,[(n(!0),u(F,null,M(b.value,c=>(n(),u("li",{key:c.name,class:"flex items-center justify-between px-3 py-1 bg-gray-100 hover:bg-gray-50 dark:bg-gray-700 dark:hover:bg-slate-800"},[e("div",null,[e("div",O,i(c.name),1),e("div",Q,i((c.size/1024).toFixed(1))+" KB ",1)]),e("div",U,[e("a",{href:l.route("admin.backup.download",{filename:c.name}),title:s(t)("download"),class:"w-8 h-8 flex items-center justify-center rounded-sm border border-slate-400 dark:border-slate-200 bg-indigo-100 hover:bg-indigo-200 dark:bg-indigo-700 dark:hover:bg-indigo-500 text-indigo-600 dark:text-slate-100 transition"},Y,8,W),e("button",{title:s(t)("recover"),onClick:w=>g(c.name),disabled:r.value,class:"w-8 h-8 flex items-center justify-center rounded-sm border border-slate-400 dark:border-slate-200 bg-teal-200 hover:bg-teal-300 dark:bg-teal-700 dark:hover:bg-teal-600 text-teal-600 dark:text-slate-100 transition"},te,8,Z),e("button",{title:s(t)("remove"),onClick:w=>x(c.name),disabled:r.value,class:"w-8 h-8 flex items-center justify-center rounded-sm border border-slate-400 dark:border-slate-200 bg-red-200 hover:bg-red-300 dark:bg-red-700 dark:hover:bg-red-600 text-red-600 dark:text-slate-100 transition"},re,8,ae)])]))),128))]))])])])]),_:1},8,["title"]))}};export{ke as default};
