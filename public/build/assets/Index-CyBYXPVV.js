import{u as P,m as x,o as v,f as e,t as r,k as o,l as $,C as I,i as f,w as S,F as q,v as W,D as X,y as Y,E as w,G as V,e as D,n as L,p as M}from"./vendor-BEBDZ0sp.js";import{A as ee}from"./AdminLayout-TrfrbzAn.js";import{T as te}from"./TitlePage-DJKfB1_5.js";import{_ as se}from"./DefaultButton-CwH6gKRp.js";import{_ as le,a as oe,b as ae}from"./CountTable-XEwDSe2k.js";import{_ as re,a as ie,b as ne}from"./SearchInput-TuOF_y9b.js";import{_ as ce,a as de}from"./RightToggle-xK72_m8s.js";import{_ as ue}from"./ActivityToggle-Dd_0Qj5d.js";import{_ as pe}from"./IconEdit-DzaKHCZk.js";import{a as R}from"./vendor-axios-jn5v1YEJ.js";import"./vendor-lodash-CeR_jfIo.js";import"./ScrollButtons-C6QmoBlh.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ResponsiveNavLink-fXlkiuVz.js";import"./LocaleSelectOption-Bf35oBpC.js";import"./app-srWkjDCr.js";import"./auth-image-XbvYdkSi.js";const he={class:"flex justify-center items-center h-fit sm:mr-4 mt-2 mb-2"},ve={for:"sortParam",class:"hidden lg:block sm:mr-2 tracking-wider text-sm font-semibold text-slate-600 dark:text-slate-100"},ge=["value"],me={value:"idDesc"},fe={value:"idAsc"},_e={value:"sort"},xe={value:"title"},ye={value:"activity"},be={value:"inactive"},we={value:"left"},$e={value:"noLeft"},ke={value:"right"},Se={value:"noRight"},Ae={__name:"SortSelect",props:{sortParam:String},emits:["update:sortParam"],setup(g,{emit:i}){const{t:l}=P(),y=i,p=c=>{y("update:sortParam",c.target.value)};return(c,A)=>(v(),x("div",he,[e("label",ve,r(o(l)("sort")),1),e("select",{id:"sortParam",value:g.sortParam,onChange:p,class:"w-56 px-3 py-0.5 form-select bg-white dark:bg-gray-200 text-gray-600 dark:text-gray-900 border border-slate-400 dark:border-slate-600 rounded-sm shadow-sm"},[e("option",me,r(o(l)("idDesc")),1),e("option",fe,r(o(l)("idAsc")),1),e("option",_e,r(o(l)("sortNumber")),1),e("option",xe,r(o(l)("title")),1),e("option",ye,r(o(l)("active")),1),e("option",be,r(o(l)("inactive")),1),e("option",we,r(o(l)("inLeft")),1),e("option",$e,r(o(l)("notLeft")),1),e("option",ke,r(o(l)("inRight")),1),e("option",Se,r(o(l)("notRight")),1)],40,ge)]))}},Te={class:"bg-white dark:bg-slate-700 shadow-lg rounded-sm border border-slate-200 dark:border-slate-600 relative"},Be={class:"overflow-x-auto"},Ce={key:0,class:"table-auto w-full text-slate-700 dark:text-slate-100"},De={class:"text-sm uppercase bg-slate-200 dark:bg-cyan-900 border border-solid border-gray-300 dark:border-gray-700"},Le=e("th",{class:"px-2 py-3 w-px"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4 fill-current text-slate-800 dark:text-slate-200",height:"24",width:"24",viewBox:"0 0 24 24"},[e("path",{d:"M12.707,2.293a1,1,0,0,0-1.414,0l-5,5A1,1,0,0,0,7.707,8.707L12,4.414l4.293,4.293a1,1,0,0,0,1.414-1.414Z"}),e("path",{d:"M16.293,15.293,12,19.586,7.707,15.293a1,1,0,0,0-1.414,1.414l5,5a1,1,0,0,0,1.414,0l5-5a1,1,0,0,0-1.414-1.414Z"})])],-1),Pe={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap w-px"},Ee={class:"font-medium text-center"},Ve={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},Me=["title"],Re=e("svg",{class:"w-6 h-6 fill-current shrink-0",viewBox:"0 0 512 512"},[e("path",{d:"M0 96C0 60.7 28.7 32 64 32l384 0c35.3 0 64 28.7 64 64l0 320c0 35.3-28.7 64-64 64L64 480c-35.3 0-64-28.7-64-64L0 96zM323.8 202.5c-4.5-6.6-11.9-10.5-19.8-10.5s-15.4 3.9-19.8 10.5l-87 127.6L170.7 297c-4.6-5.7-11.5-9-18.7-9s-14.2 3.3-18.7 9l-64 80c-5.8 7.2-6.9 17.1-2.9 25.4s12.4 13.6 21.6 13.6l96 0 32 0 208 0c8.9 0 17.1-4.9 21.2-12.8s3.6-17.4-1.4-24.7l-120-176zM112 192a48 48 0 1 0 0-96 48 48 0 1 0 0 96z"})],-1),Ie=[Re],je={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},ze={class:"font-medium text-left"},Ue={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},Ne={class:"font-medium text-left"},Oe={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},Fe={class:"font-medium text-left"},He={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},Je={class:"font-medium text-center"},Ke={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},Ze={class:"font-medium text-center"},Ge={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},Qe={class:"text-center"},qe={class:"text-sm font-semibold border-b-2 hover:bg-slate-100 dark:hover:bg-cyan-800"},We=e("td",{class:"px-2 py-1 text-center cursor-move handle"},[e("svg",{class:"w-4 h-4 text-gray-500 dark:text-gray-300",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M7 4h2v2H7V4zm4 0h2v2h-2V4zM7 8h2v2H7V8zm4 0h2v2h-2V8zM7 12h2v2H7v-2zm4 0h2v2h-2v-2z"})])],-1),Xe={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},Ye={class:"text-center text-blue-600 dark:text-blue-200"},et={class:"first:pl-5 last:pr-5 py-1"},tt={class:"flex justify-center"},st=["src","alt","title"],lt=["alt"],ot={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},at={class:"text-left text-teal-600 dark:text-violet-200"},rt={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},it={class:"text-left text-teal-600 dark:text-violet-200"},nt={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},ct={class:"text-left"},dt=["title"],ut={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},pt={class:"flex justify-center space-x-2"},ht={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},vt={class:"flex justify-center space-x-2"},gt={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},mt={class:"text-center"},ft=["checked","onChange"],_t={key:1,class:"p-5 text-center text-slate-700 dark:text-slate-100"},xt={__name:"BannerTable",props:{banners:Array,selectedBanners:Array},emits:["toggle-left","toggle-right","toggle-activity","edit","delete","update-sort-order","toggle-select","toggle-all"],setup(g,{emit:i}){const{t:l}=P(),y=g,p=i,c=$([]);I(()=>y.banners,u=>{c.value=JSON.parse(JSON.stringify(u||[]))},{immediate:!0,deep:!0});const A=()=>{const u=c.value.map(m=>m.id);p("update-sort-order",u)},k=u=>{const m=u.target.checked,n=c.value.map(_=>_.id);p("toggle-all",{ids:n,checked:m})},b=u=>u.images&&u.images.length?[...u.images].sort((m,n)=>m.order-n.order)[0]:null;return(u,m)=>(v(),x("div",Te,[e("div",Be,[g.banners.length>0?(v(),x("table",Ce,[e("thead",De,[e("tr",null,[Le,e("th",Pe,[e("div",Ee,r(o(l)("id")),1)]),e("th",Ve,[e("div",{class:"flex justify-center",title:o(l)("image")},Ie,8,Me)]),e("th",je,[e("div",ze,r(o(l)("title")),1)]),e("th",Ue,[e("div",Ne,r(o(l)("url")),1)]),e("th",Oe,[e("div",Fe,r(o(l)("sections")),1)]),e("th",He,[e("div",Je,r(o(l)("show")),1)]),e("th",Ke,[e("div",Ze,r(o(l)("actions")),1)]),e("th",Ge,[e("div",Qe,[e("input",{type:"checkbox",onChange:k},null,32)])])])]),f(o(X),{tag:"tbody",modelValue:c.value,"onUpdate:modelValue":m[0]||(m[0]=n=>c.value=n),onEnd:A,itemKey:"id",handle:".handle"},{item:S(({element:n})=>[e("tr",qe,[We,e("td",Xe,[e("div",Ye,r(n.id),1)]),e("td",et,[e("div",tt,[n.images&&n.images.length?(v(),x("img",{key:0,src:b(n).webp_url||b(n).url,alt:b(n).alt||o(l)("defaultImageAlt"),title:b(n).caption||o(l)("postImage"),class:"h-8 w-8 object-cover rounded-full"},null,8,st)):(v(),x("img",{key:1,src:"/storage/banner_images/default-image.png",alt:o(l)("defaultImageTitle"),class:"h-8 w-8 object-cover rounded-full"},null,8,lt))])]),e("td",ot,[e("div",at,r(n.title),1)]),e("td",rt,[e("div",it,r(n.link),1)]),e("td",nt,[e("div",ct,[(v(!0),x(q,null,W(n.sections,_=>(v(),x("span",{key:_.id},[e("span",{title:_.title,class:"py-0.5 px-1.5 mr-0.5 badge bg-blue-500 dark:bg-blue-200 rounded-sm text-xs text-slate-100 dark:text-slate-900"},r(_.id),9,dt)]))),128))])]),e("td",ut,[e("div",pt,[f(ce,{isActive:n.left,onToggleLeft:_=>u.$emit("toggle-left",n),title:n.left?o(l)("enabled"):o(l)("disabled")},null,8,["isActive","onToggleLeft","title"]),f(de,{isActive:n.right,onToggleRight:_=>u.$emit("toggle-right",n),title:n.right?o(l)("enabled"):o(l)("disabled")},null,8,["isActive","onToggleRight","title"])])]),e("td",ht,[e("div",vt,[f(ue,{isActive:n.activity,onToggleActivity:_=>u.$emit("toggle-activity",n),title:n.activity?o(l)("enabled"):o(l)("disabled")},null,8,["isActive","onToggleActivity","title"]),f(pe,{href:u.route("admin.banners.edit",n.id)},null,8,["href"]),f(le,{onDelete:_=>u.$emit("delete",n.id)},null,8,["onDelete"])])]),e("td",gt,[e("div",mt,[e("input",{type:"checkbox",checked:g.selectedBanners.includes(n.id),onChange:_=>u.$emit("toggle-select",n.id)},null,40,ft)])])])]),_:1},8,["modelValue"])])):(v(),x("div",_t,r(o(l)("noData")),1))])]))}},yt={class:"flex flex-col sm:flex-row items-center"},bt={class:"block mb-2 sm:mb-0 sm:mr-2 font-semibold text-sm text-slate-700 dark:text-slate-500"},wt={value:"",disabled:"",selected:""},$t={value:"selectAll"},kt={value:"deselectAll"},St={value:"activate"},At={value:"deactivate"},Tt={value:"left"},Bt={value:"noLeft"},Ct={value:"right"},Dt={value:"noRight"},Lt={value:"delete"},Pt={__name:"BulkActionSelect",props:{handleBulkAction:Function},emits:["change"],setup(g,{emit:i}){const{t:l}=P();return(y,p)=>(v(),x("div",yt,[e("label",bt,r(o(l)("bulkActions")),1),e("select",{class:"w-auto px-3 py-0.5 form-select bg-white dark:bg-gray-200 text-gray-600 dark:text-gray-900 border border-slate-400 dark:border-slate-600 rounded-sm shadow-sm",onChange:p[0]||(p[0]=c=>y.$emit("change",c))},[e("option",wt,r(o(l)("selectAction")),1),e("option",$t,r(o(l)("selectAll")),1),e("option",kt,r(o(l)("deselectAll")),1),e("option",St,r(o(l)("activate")),1),e("option",At,r(o(l)("deactivate")),1),e("option",Tt,r(o(l)("left")),1),e("option",Bt,r(o(l)("noLeft")),1),e("option",Ct,r(o(l)("right")),1),e("option",Dt,r(o(l)("noRight")),1),e("option",Lt,r(o(l)("deleteSelected")),1)],32)]))}},Et={class:"px-4 sm:px-6 lg:px-8 py-8 w-full max-w-12xl mx-auto"},Vt={class:"p-4 bg-slate-50 dark:bg-slate-700 border border-blue-400 dark:border-blue-200 overflow-hidden shadow-lg shadow-gray-500 dark:shadow-slate-400 bg-opacity-95 dark:bg-opacity-95"},Mt={class:"sm:flex sm:justify-between sm:items-center mb-2"},Rt=e("svg",{class:"w-4 h-4 fill-current opacity-50 shrink-0",viewBox:"0 0 16 16"},[e("path",{d:"M15 7H9V1c0-.6-.4-1-1-1S7 .4 7 1v6H1c-.6 0-1 .4-1 1s.4 1 1 1h6v6c0 .6.4 1 1 1s1-.4 1-1V9h6c.6 0 1-.4 1-1s-.4-1-1-1z"})],-1),It={key:2,class:"flex justify-between items-center flex-col md:flex-row my-1"},ts={__name:"Index",props:["banners","bannersCount","adminCountBanners","adminSortBanners"],setup(g){const i=Y(),{t:l}=P(),y=g,p=$(y.adminCountBanners);I(p,s=>{w.put(route("admin.settings.updateAdminCountBanners"),{value:s},{preserveScroll:!0,preserveState:!0,onSuccess:()=>i.info(`Показ ${s} элементов на странице.`),onError:t=>i.error(t.value||"Ошибка обновления кол-ва элементов.")})});const c=$(y.adminSortBanners);I(c,s=>{w.put(route("admin.settings.updateAdminSortBanners"),{value:s},{preserveScroll:!0,preserveState:!0,onSuccess:()=>i.info("Сортировка успешно изменена"),onError:t=>i.error(t.value||"Ошибка обновления сортировки.")})});const A=$(!1),k=$(null),b=$(""),u=(s,t)=>{k.value=s,b.value=t,A.value=!0},m=()=>{A.value=!1,k.value=null,b.value=""},n=()=>{if(k.value===null)return;const s=k.value,t=b.value;w.delete(route("admin.banners.destroy",{banner:s}),{preserveScroll:!0,preserveState:!1,onSuccess:a=>{m(),i.success(`Баннер "${t||"ID: "+s}" удален.`)},onError:a=>{m();const h=a.general||a[Object.keys(a)[0]]||"Произошла ошибка при удалении.";i.error(`${h} (Баннер: ${t||"ID: "+s})`),console.error("Ошибка удаления:",a)},onFinish:()=>{k.value=null,b.value=""}})},_=s=>{const t=!s.left,a=t?"активирован в левой колонке":"деактивирован в левой колонке";w.put(route("admin.actions.banners.updateLeft",{banner:s.id}),{left:t},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{i.success(`Баннер "${s.title}" ${a}.`)},onError:h=>{i.error(h.left||h.general||`Ошибка изменения активности для "${s.title}".`)}})},N=s=>{const t=!s.right,a=t?"активирован в правой колонке":"деактивирован в правой колонке";w.put(route("admin.actions.banners.updateRight",{banner:s.id}),{right:t},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{i.success(`Баннер "${s.title}" ${a}.`)},onError:h=>{i.error(h.right||h.general||`Ошибка изменения активности для "${s.title}".`)}})},O=s=>{const t=!s.activity,a=t?"активирован":"деактивирован";w.put(route("admin.actions.banners.updateActivity",{banner:s.id}),{activity:t},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{i.success(`Баннер "${s.title}" ${a}.`)},onError:h=>{i.error(h.activity||h.general||`Ошибка изменения активности для "${s.title}".`)}})},B=$(1),C=$(""),F=s=>c.value==="idAsc"?s.slice().sort((t,a)=>t.id-a.id):c.value==="idDesc"?s.slice().sort((t,a)=>a.id-t.id):c.value==="activity"?s.filter(t=>t.activity):c.value==="inactive"?s.filter(t=>!t.activity):c.value==="left"?s.filter(t=>t.left):c.value==="noLeft"?s.filter(t=>!t.left):c.value==="right"?s.filter(t=>t.right):c.value==="noRight"?s.filter(t=>!t.right):s.slice().sort((t,a)=>t[c.value]<a[c.value]?-1:t[c.value]>a[c.value]?1:0),E=V(()=>{let s=y.banners;return C.value&&(s=s.filter(t=>t.title.toLowerCase().includes(C.value.toLowerCase()))),F(s)}),T=V(()=>{const s=(B.value-1)*p.value;return E.value.slice(s,s+p.value)});V(()=>Math.ceil(E.value.length/p.value));const H=s=>{const t=(B.value-1)*p.value,a=s.map((h,Q)=>({id:h,sort:t+Q+1}));w.put(route("admin.actions.banners.updateSortBulk"),{banners:a},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{i.success("Порядок баннеров успешно обновлен.")},onError:h=>{console.error("Ошибка обновления сортировки:",h),i.error(h.general||h.banners||"Не удалось обновить порядок баннеров."),w.reload({only:["banners"],preserveScroll:!0})}})},d=$([]),J=({ids:s,checked:t})=>{t?d.value=[...new Set([...d.value,...s])]:d.value=d.value.filter(a=>!s.includes(a))},K=s=>{const t=d.value.indexOf(s);t>-1?d.value.splice(t,1):d.value.push(s)},j=s=>{if(!d.value.length){i.warning("Выберите баннер для активации/деактивации баннеров");return}R.put(route("admin.actions.banners.bulkUpdateActivity"),{ids:d.value,activity:s}).then(()=>{i.success("Активность массово обновлена");const t=[...d.value];d.value=[],T.value.forEach(a=>{t.includes(a.id)&&(a.activity=s)})}).catch(()=>{i.error("Не удалось обновить активность")})},z=s=>{if(d.value.length===0){i.warning(`Выберите баннера для ${s?"активации в левой колонки":"деактивации в левой колонки"}.`);return}R.put(route("admin.actions.banners.bulkUpdateLeft"),{ids:d.value,left:s}).then(()=>{i.success("Статус в левой колонки массово обновлен");const t=[...d.value];d.value=[],T.value.forEach(a=>{t.includes(a.id)&&(a.left=s)})}).catch(()=>{i.error("Не удалось обновить статус в левой колонке")})},U=s=>{if(d.value.length===0){i.warning(`Выберите баннера для ${s?"активации":"деактивации"}.`);return}R.put(route("admin.actions.banners.bulkUpdateRight"),{ids:d.value,right:s}).then(()=>{i.success("Статус в правой колонки массово обновлен");const t=[...d.value];d.value=[],T.value.forEach(a=>{t.includes(a.id)&&(a.right=s)})}).catch(()=>{i.error("Не удалось обновить статус в правой колонке")})},Z=()=>{if(d.value.length===0){i.warning("Выберите хотя бы один баннер для удаления.");return}confirm("Вы уверены, что хотите их удалить ?")&&w.delete(route("admin.actions.banners.bulkDestroy"),{data:{ids:d.value},preserveScroll:!0,preserveState:!1,onSuccess:s=>{d.value=[],i.success("Массовое удаление баннеров успешно завершено.")},onError:s=>{console.error("Ошибка массового удаления:",s);const t=Object.keys(s)[0],a=s[t]||"Произошла ошибка при удалении баннеров.";i.error(a)}})},G=s=>{const t=s.target.value;t==="selectAll"?d.value=T.value.map(a=>a.id):t==="deselectAll"?d.value=[]:t==="activate"?j(!0):t==="deactivate"?j(!1):t==="left"?z(!0):t==="noLeft"?z(!1):t==="right"?U(!0):t==="noRight"?U(!1):t==="delete"&&Z(),s.target.value=""};return(s,t)=>(v(),D(ee,{title:o(l)("banners")},{header:S(()=>[f(te,null,{default:S(()=>[M(r(o(l)("banners")),1)]),_:1})]),default:S(()=>[e("div",Et,[e("div",Vt,[e("div",Mt,[f(se,{href:s.route("admin.banners.create")},{icon:S(()=>[Rt]),default:S(()=>[M(" "+r(o(l)("addBanner")),1)]),_:1},8,["href"]),g.bannersCount?(v(),D(Pt,{key:0,onChange:G})):L("",!0)]),g.bannersCount?(v(),D(re,{key:0,modelValue:C.value,"onUpdate:modelValue":t[0]||(t[0]=a=>C.value=a),placeholder:o(l)("searchByName")},null,8,["modelValue","placeholder"])):L("",!0),g.bannersCount?(v(),D(oe,{key:1},{default:S(()=>[M(r(g.bannersCount),1)]),_:1})):L("",!0),f(xt,{banners:T.value,"selected-banners":d.value,onToggleLeft:_,onToggleRight:N,onToggleActivity:O,onDelete:u,onUpdateSortOrder:H,onToggleSelect:K,onToggleAll:J},null,8,["banners","selected-banners"]),g.bannersCount?(v(),x("div",It,[f(ie,{"items-per-page":p.value,"onUpdate:itemsPerPage":t[1]||(t[1]=a=>p.value=a)},null,8,["items-per-page"]),f(ne,{"current-page":B.value,"items-per-page":p.value,"total-items":E.value.length,"onUpdate:currentPage":t[2]||(t[2]=a=>B.value=a)},null,8,["current-page","items-per-page","total-items"]),f(Ae,{sortParam:c.value,"onUpdate:sortParam":t[3]||(t[3]=a=>c.value=a)},null,8,["sortParam"])])):L("",!0)])]),f(ae,{show:A.value,onClose:m,onCancel:m,onConfirm:n,cancelText:o(l)("cancel"),confirmText:o(l)("yesDelete")},null,8,["show","cancelText","confirmText"])]),_:1},8,["title"]))}};export{ts as default};
