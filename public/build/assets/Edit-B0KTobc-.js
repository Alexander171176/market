import{y as S,u as L,T as q,Q as H,l as k,e as N,o as P,w as m,f as l,i as o,p as f,t as d,k as t,A as $,q as A}from"./vendor-CMULZhQa.js";import{_ as K,t as Q}from"./MetatagsButton-DFHL53iq.js";import{A as G}from"./AdminLayout-BMfLiLo0.js";import{T as J}from"./TitlePage-DOI2IMRH.js";import{_ as M}from"./DefaultButton-CB_WTPCQ.js";import{_ as p,a as h}from"./InputText-BO1leBMl.js";import{_}from"./InputError-B8v-5UJo.js";import{_ as R}from"./PrimaryButton-BQKaB6gG.js";import{_ as W,a as X}from"./TinyEditor-zoGYMinn.js";import{_ as U}from"./MetaDescTextarea-BqXrk_pu.js";import{_ as Y}from"./ClearMetaButton-BG4n4BXu.js";import{_ as Z,a as ee,b as te}from"./InputNumber-BKnpntqH.js";import{_ as se}from"./SelectParentCategory-BQjkudYj.js";import{_ as le}from"./MultiImageUpload-B1nZ7a18.js";import{_ as ae}from"./MultiImageEdit-BcZmVenZ.js";import"./vendor-axios-jn5v1YEJ.js";import"./vendor-lodash-3g6-h99u.js";import"./sidebarIcons-D5nT6JI0.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ResponsiveNavLink-BBt1gw6L.js";import"./ScrollButtons-DjRj6zOj.js";import"./app-BmuzEqX8.js";import"./auth-image-XbvYdkSi.js";const oe={class:"px-4 sm:px-6 lg:px-8 py-8 w-full max-w-12xl mx-auto"},re={class:"p-4 bg-slate-50 dark:bg-slate-700 border border-blue-400 dark:border-blue-200 shadow-lg shadow-gray-500 dark:shadow-slate-400 bg-opacity-95 dark:bg-opacity-95"},ie={class:"sm:flex sm:justify-between sm:items-center mb-2"},de=l("svg",{class:"w-4 h-4 fill-current text-slate-100 shrink-0 mr-2",viewBox:"0 0 16 16"},[l("path",{d:"M4.3 4.5c1.9-1.9 5.1-1.9 7 0 .7.7 1.2 1.7 1.4 2.7l2-.3c-.2-1.5-.9-2.8-1.9-3.8C10.1.4 5.7.4 2.9 3.1L.7.9 0 7.3l6.4-.7-2.1-2.1zM15.6 8.7l-6.4.7 2.1 2.1c-1.9 1.9-5.1 1.9-7 0-.7-.7-1.2-1.7-1.4-2.7l-2 .3c.2 1.5.9 2.8 1.9 3.8 1.4 1.4 3.1 2 4.9 2 1.8 0 3.6-.7 4.9-2l2.2 2.2.8-6.4z"})],-1),ne=l("div",{class:"grid grid-flow-col sm:auto-cols-max justify-start sm:justify-end gap-2"},null,-1),ce={class:"mb-3 flex justify-between flex-col lg:flex-row items-center gap-4"},me={class:"flex flex-row items-center gap-2"},ue={class:"flex flex-row items-center w-auto"},_e={class:"flex flex-row items-center gap-2"},fe={class:"h-8 flex items-center"},pe={class:"mb-3 flex flex-col items-start"},ge={class:"flex justify-between w-full"},xe=l("span",{class:"text-red-500 dark:text-red-300 font-semibold"},"*",-1),he={class:"text-md text-gray-900 dark:text-gray-400 mt-1"},ye={class:"mb-3 flex flex-col items-start"},ve=l("span",{class:"text-red-500 dark:text-red-300 font-semibold"},"*",-1),we={class:"mb-3 flex flex-col items-start"},be={class:"flex justify-between w-full"},Ve={class:"text-md text-gray-900 dark:text-gray-400 mt-1"},ke={class:"mb-3 flex flex-col items-start"},$e={class:"mb-3 flex flex-col items-start"},Me={class:"flex justify-between w-full"},Ue={class:"text-md text-gray-900 dark:text-gray-400 mt-1"},je={class:"mb-3 flex flex-col items-start"},Ie={class:"flex justify-between w-full"},Ce={class:"text-md text-gray-900 dark:text-gray-400 mt-1"},ze={class:"mb-3 flex flex-col items-start"},Be={class:"flex justify-between w-full"},Te={class:"text-md text-gray-900 dark:text-gray-400 mt-1"},De={class:"flex justify-end mt-4"},Oe=l("svg",{class:"w-4 h-4 fill-current text-gray-500 shrink-0 mr-2",viewBox:"0 0 16 16"},[l("path",{d:"M8 0C3.58 0 0 3.58 0 8s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm3 9H5V7h6v2z"})],-1),Ee=l("svg",{class:"w-4 h-4 fill-current text-slate-600 shrink-0 mr-2",viewBox:"0 0 16 16"},[l("path",{d:"M13 7h2v6a1 1 0 01-1 1H4v2l-4-3 4-3v2h9V7zM3 9H1V3a1 1 0 011-1h10V0l4 3-4 3V4H3v5z"})],-1),Fe={class:"mt-4"},Se={class:"mt-4"},Le={class:"flex items-center justify-center mt-4"},qe=l("svg",{class:"w-4 h-4 fill-current text-slate-100 shrink-0 mr-2",viewBox:"0 0 16 16"},[l("path",{d:"M4.3 4.5c1.9-1.9 5.1-1.9 7 0 .7.7 1.2 1.7 1.4 2.7l2-.3c-.2-1.5-.9-2.8-1.9-3.8C10.1.4 5.7.4 2.9 3.1L.7.9 0 7.3l6.4-.7-2.1-2.1zM15.6 8.7l-6.4.7 2.1 2.1c-1.9 1.9-5.1 1.9-7 0-.7-.7-1.2-1.7-1.4-2.7l-2 .3c.2 1.5.9 2.8 1.9 3.8 1.4 1.4 3.1 2 4.9 2 1.8 0 3.6-.7 4.9-2l2.2 2.2.8-6.4z"})],-1),He=l("svg",{class:"w-4 h-4 fill-current text-slate-100",viewBox:"0 0 16 16"},[l("path",{d:"M14.3 2.3L5 11.6 1.7 8.3c-.4-.4-1-.4-1.4 0-.4.4-.4 1 0 1.4l4 4c.2.2.4.3.7.3.3 0 .5-.1.7-.3l10-10c.4-.4.4-1 0-1.4-.4-.4-1-.4-1.4 0z"})],-1),mt={__name:"Edit",props:{category:{type:Object,required:!0}},setup(j){var V;const v=S(),{t:i}=L(),n=j,e=q({_method:"POST",parent_id:n.category.parent_id??null,sort:n.category.sort??0,title:(V=n.category)==null?void 0:V.title,locale:n.category.locale??"",url:n.category.url??"",short:n.category.short??"",description:n.category.description??"",meta_title:n.category.meta_title??"",meta_keywords:n.category.meta_keywords??"",meta_desc:n.category.meta_desc??"",activity:!!(n.category.activity??!1),deletedImages:[]}),I=H(),C=b(I.props.potentialParents),g=k((n.category.images||[]).filter(s=>s.url).map(s=>({id:s.id,url:s.webp_url||s.url,order:s.order||0,alt:s.alt||"",caption:s.caption||""}))),w=k([]),z=s=>{g.value=s},B=s=>{e.deletedImages.includes(s)||e.deletedImages.push(s),g.value=g.value.filter(a=>a.id!==s)},T=s=>{w.value=s};function b(s,a=null,r=0){let c=[];return s.filter(u=>u.parent_id===a).sort((u,x)=>(u.sort||0)-(x.sort||0)).forEach(u=>{c.push({id:u.id,title:`${"— ".repeat(r)}${u.title}`});const x=b(s,u.id,r+1);c=c.concat(x)}),c}const D=()=>{e.title&&(e.url=Q(e.title.toLowerCase()))},y=(s,a,r=!1)=>{if(s.length<=a)return s;const c=s.substr(0,s.lastIndexOf(" ",a));return r?`${c}...`:c},O=()=>{e.meta_title="",e.meta_keywords="",e.meta_desc=""},E=()=>{if(e.title&&!e.meta_title&&(e.meta_title=y(e.title,160)),!e.meta_keywords&&e.short){let s=e.short.replace(/(<([^>]+)>)/gi,"");s=s.replace(/[.,!?;:()\[\]{}"'«»]/g,"");const r=s.split(/\s+/).filter(c=>c&&c.length>=3).map(c=>c.toLowerCase()).filter((c,u,x)=>x.indexOf(c)===u).join(", ");e.meta_keywords=y(r,255)}if(e.short&&!e.meta_desc){const s=e.short.replace(/(<([^>]+)>)/gi,"");e.meta_desc=y(s,200,!0)}},F=()=>{e.transform(s=>({...s,parent_id:s.parent_id??"",activity:s.activity?"1":"0",locale:s.locale||"",title:s.title||"",url:s.url||"",sort:String(s.sort??"0"),images:[...w.value.map(a=>({file:a.file,order:a.order,alt:a.alt,caption:a.caption})),...g.value.map(a=>({id:a.id,order:a.order,alt:a.alt,caption:a.caption}))],deletedImages:e.deletedImages})),e.post(route("admin.categories.update",n.category.id),{errorBag:"editCategory",preserveScroll:!0,forceFormData:!0,onSuccess:()=>{v.success("Категория успешно обновлена!")},onError:s=>{console.error("Не удалось отправить форму:",s);const a=s[Object.keys(s)[0]];v.error(a||"Пожалуйста, проверьте правильность заполнения полей.")}})};return(s,a)=>(P(),N(G,{title:t(i)("editCategory")},{header:m(()=>[o(J,null,{default:m(()=>[f(d(t(i)("editCategory"))+" ID:"+d(n.category.id),1)]),_:1})]),default:m(()=>[l("div",oe,[l("div",re,[l("div",ie,[o(M,{href:s.route("admin.categories.index",{locale:n.category.locale})},{icon:m(()=>[de]),default:m(()=>[f(" "+d(t(i)("back")),1)]),_:1},8,["href"]),ne]),l("form",{onSubmit:$(F,["prevent"]),enctype:"multipart/form-data",class:"p-3 w-full"},[l("div",ce,[l("div",me,[o(Z,{modelValue:t(e).activity,"onUpdate:modelValue":a[0]||(a[0]=r=>t(e).activity=r)},null,8,["modelValue"]),o(ee,{for:"activity",text:t(i)("activity"),class:"text-sm h-8 flex items-center"},null,8,["text"])]),l("div",ue,[o(W,{modelValue:t(e).locale,"onUpdate:modelValue":a[1]||(a[1]=r=>t(e).locale=r),errorMessage:t(e).errors.locale},null,8,["modelValue","errorMessage"]),o(_,{class:"mt-2 lg:mt-0",message:t(e).errors.locale},null,8,["message"])]),l("div",_e,[l("div",fe,[o(p,{for:"sort",value:t(i)("sort"),class:"text-sm"},null,8,["value"])]),o(te,{id:"sort",type:"number",modelValue:t(e).sort,"onUpdate:modelValue":a[2]||(a[2]=r=>t(e).sort=r),autocomplete:"sort",class:"w-full lg:w-28"},null,8,["modelValue"]),o(_,{class:"mt-2 lg:mt-0",message:t(e).errors.sort},null,8,["message"])])]),o(se,{modelValue:t(e).parent_id,"onUpdate:modelValue":a[3]||(a[3]=r=>t(e).parent_id=r),options:t(C),errorMessage:t(e).errors.parent_id},null,8,["modelValue","options","errorMessage"]),l("div",pe,[l("div",ge,[o(p,{for:"title"},{default:m(()=>[xe,f(" "+d(t(i)("title")),1)]),_:1}),l("div",he,d(t(e).title.length)+" / 100 "+d(t(i)("characters")),1)]),o(h,{id:"name",type:"text",modelValue:t(e).title,"onUpdate:modelValue":a[4]||(a[4]=r=>t(e).title=r),maxlength:"100",required:"",autocomplete:"name"},null,8,["modelValue"]),o(_,{class:"mt-2",message:t(e).errors.name},null,8,["message"])]),l("div",ye,[o(p,{for:"url"},{default:m(()=>[ve,f(" "+d(t(i)("url")),1)]),_:1}),o(h,{id:"url",type:"text",modelValue:t(e).url,"onUpdate:modelValue":a[5]||(a[5]=r=>t(e).url=r),required:"",autocomplete:"url",onFocus:D},null,8,["modelValue"]),o(_,{class:"mt-2",message:t(e).errors.url},null,8,["message"])]),l("div",we,[l("div",be,[o(p,{for:"short",value:t(i)("shortDescription")},null,8,["value"]),l("div",Ve,d(t(e).short.length)+" / 255 "+d(t(i)("characters")),1)]),o(U,{modelValue:t(e).short,"onUpdate:modelValue":a[6]||(a[6]=r=>t(e).short=r),class:"w-full"},null,8,["modelValue"]),o(_,{class:"mt-2",message:t(e).errors.short},null,8,["message"])]),l("div",ke,[o(p,{for:"description",value:t(i)("description")},null,8,["value"]),o(X,{modelValue:t(e).description,"onUpdate:modelValue":a[7]||(a[7]=r=>t(e).description=r),height:500},null,8,["modelValue"]),o(_,{class:"mt-2",message:t(e).errors.description},null,8,["message"])]),l("div",$e,[l("div",Me,[o(p,{for:"meta_title",value:t(i)("metaTitle")},null,8,["value"]),l("div",Ue,d(t(e).meta_title.length)+" / 160 "+d(t(i)("characters")),1)]),o(h,{id:"meta_title",type:"text",modelValue:t(e).meta_title,"onUpdate:modelValue":a[8]||(a[8]=r=>t(e).meta_title=r),maxlength:"160",autocomplete:"url"},null,8,["modelValue"]),o(_,{class:"mt-2",message:t(e).errors.meta_title},null,8,["message"])]),l("div",je,[l("div",Ie,[o(p,{for:"meta_keywords",value:t(i)("metaKeywords")},null,8,["value"]),l("div",Ce,d(t(e).meta_keywords.length)+" / 255 "+d(t(i)("characters")),1)]),o(h,{id:"meta_keywords",type:"text",modelValue:t(e).meta_keywords,"onUpdate:modelValue":a[9]||(a[9]=r=>t(e).meta_keywords=r),maxlength:"255",autocomplete:"url"},null,8,["modelValue"]),o(_,{class:"mt-2",message:t(e).errors.meta_keywords},null,8,["message"])]),l("div",ze,[l("div",Be,[o(p,{for:"meta_desc",value:t(i)("metaDescription")},null,8,["value"]),l("div",Te,d(t(e).meta_desc.length)+" / 200 "+d(t(i)("characters")),1)]),o(U,{modelValue:t(e).meta_desc,"onUpdate:modelValue":a[10]||(a[10]=r=>t(e).meta_desc=r),maxlength:"200",class:"w-full"},null,8,["modelValue"]),o(_,{class:"mt-2",message:t(e).errors.meta_desc},null,8,["message"])]),l("div",De,[o(Y,{onClear:O,class:"mr-4"},{default:m(()=>[Oe,f(" "+d(t(i)("clearMetaFields")),1)]),_:1}),o(K,{onClick:$(E,["prevent"])},{icon:m(()=>[Ee]),default:m(()=>[f(" "+d(t(i)("generateMetaTags")),1)]),_:1})]),l("div",Fe,[o(ae,{images:g.value,"onUpdate:images":z,onDeleteImage:B},null,8,["images"])]),l("div",Se,[o(le,{"onUpdate:images":T})]),l("div",Le,[o(M,{href:s.route("admin.categories.index",{locale:n.category.locale}),class:"mb-3"},{icon:m(()=>[qe]),default:m(()=>[f(" "+d(t(i)("back")),1)]),_:1},8,["href"]),o(R,{class:A(["ms-4",{"opacity-25":t(e).processing}]),disabled:t(e).processing},{icon:m(()=>[He]),default:m(()=>[f(" "+d(t(i)("save")),1)]),_:1},8,["class","disabled"])])],32)])])]),_:1},8,["title"]))}};export{mt as default};
