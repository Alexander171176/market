import{u as P,l as f,C as E,m as S,o as _,f as e,i as m,t as r,k as l,w as b,D as K,y as Z,E as w,G as V,e as C,n as D,p as B}from"./vendor-BEBDZ0sp.js";import{A as G}from"./AdminLayout-DSdOfU-D.js";import{T as Q}from"./TitlePage-DJKfB1_5.js";import{_ as R}from"./DefaultButton-CwH6gKRp.js";import{_ as q,a as W,b as X}from"./CountTable-XEwDSe2k.js";import{_ as Y,a as ee,b as te}from"./SearchInput-TuOF_y9b.js";import{_ as se}from"./ActivityToggle-Dd_0Qj5d.js";import{_ as ae}from"./IconEdit-DzaKHCZk.js";import"./vendor-axios-jn5v1YEJ.js";import"./vendor-lodash-CeR_jfIo.js";import"./ScrollButtons-BQPx4wk5.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ResponsiveNavLink-fXlkiuVz.js";import"./LocaleSelectOption-B6VJrWhn.js";import"./app-DJPVAKIM.js";import"./auth-image-XbvYdkSi.js";const oe={class:"bg-white dark:bg-slate-700 shadow-lg rounded-sm border border-slate-200 dark:border-slate-600 relative"},le={class:"overflow-x-auto"},re={key:0,class:"table-auto w-full text-slate-700 dark:text-slate-100"},ie={class:"text-sm font-semibold uppercase bg-slate-200 dark:bg-cyan-900 border border-solid border-gray-300 dark:border-gray-700"},ne=e("th",{class:"px-2 py-3 w-px"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4 fill-current text-slate-800 dark:text-slate-200",height:"24",width:"24",viewBox:"0 0 24 24"},[e("path",{d:"M12.707,2.293a1,1,0,0,0-1.414,0l-5,5A1,1,0,0,0,7.707,8.707L12,4.414l4.293,4.293a1,1,0,0,0,1.414-1.414Z"}),e("path",{d:"M16.293,15.293,12,19.586,7.707,15.293a1,1,0,0,0-1.414,1.414l5,5a1,1,0,0,0,1.414,0l5-5a1,1,0,0,0-1.414-1.414Z"})])],-1),ce={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap w-px"},de={class:"font-semibold text-center"},ue={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},pe=["title"],ve=e("svg",{class:"w-8 h-8 fill-current shrink-0",viewBox:"0 0 640 512"},[e("path",{d:"M0 128C0 92.7 28.7 64 64 64l192 0 48 0 16 0 256 0c35.3 0 64 28.7 64 64l0 256c0 35.3-28.7 64-64 64l-256 0-16 0-48 0L64 448c-35.3 0-64-28.7-64-64L0 128zm320 0l0 256 256 0 0-256-256 0zM178.3 175.9c-3.2-7.2-10.4-11.9-18.3-11.9s-15.1 4.7-18.3 11.9l-64 144c-4.5 10.1 .1 21.9 10.2 26.4s21.9-.1 26.4-10.2l8.9-20.1 73.6 0 8.9 20.1c4.5 10.1 16.3 14.6 26.4 10.2s14.6-16.3 10.2-26.4l-64-144zM160 233.2L179 276l-38 0 19-42.8zM448 164c11 0 20 9 20 20l0 4 44 0 16 0c11 0 20 9 20 20s-9 20-20 20l-2 0-1.6 4.5c-8.9 24.4-22.4 46.6-39.6 65.4c.9 .6 1.8 1.1 2.7 1.6l18.9 11.3c9.5 5.7 12.5 18 6.9 27.4s-18 12.5-27.4 6.9l-18.9-11.3c-4.5-2.7-8.8-5.5-13.1-8.5c-10.6 7.5-21.9 14-34 19.4l-3.6 1.6c-10.1 4.5-21.9-.1-26.4-10.2s.1-21.9 10.2-26.4l3.6-1.6c6.4-2.9 12.6-6.1 18.5-9.8l-12.2-12.2c-7.8-7.8-7.8-20.5 0-28.3s20.5-7.8 28.3 0l14.6 14.6 .5 .5c12.4-13.1 22.5-28.3 29.8-45L448 228l-72 0c-11 0-20-9-20-20s9-20 20-20l52 0 0-4c0-11 9-20 20-20z"})],-1),me=[ve],he={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},_e={class:"font-semibold text-left"},ge={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},fe={class:"font-semibold text-left"},xe={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},ye=["title"],we=e("svg",{class:"w-4 h-4 fill-current shrink-0",viewBox:"0 0 16 16"},[e("path",{d:"M8 2C3.246 2 .251 7.29.127 7.515a.998.998 0 0 0 .002.975c.07.125 1.044 1.801 2.695 3.274C4.738 13.582 6.283 14 8 14c4.706 0 7.743-5.284 7.872-5.507a1 1 0 0 0 0-.98A13.292 13.292 0 0 0 8 2zm0 10a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm0-6a2 2 0 1 0 0 4 2 2 0 0 0 0-4z"})],-1),be=[we],ke={class:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"},$e={class:"font-semibold text-end"},Se={class:"px-2 first:pl-7 last:pr-7 py-3 whitespace-nowrap"},Te={class:"text-center font-medium"},Ae={class:"text-sm font-semibold border-b-2 hover:bg-slate-100 dark:hover:bg-cyan-800"},Ce=e("td",{class:"px-2 py-1 text-center cursor-move handle"},[e("svg",{class:"w-4 h-4 text-gray-500 dark:text-gray-300",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M7 4h2v2H7V4zm4 0h2v2h-2V4zM7 8h2v2H7V8zm4 0h2v2h-2V8zM7 12h2v2H7v-2zm4 0h2v2h-2v-2z"})])],-1),De={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},Pe={class:"text-center text-blue-600 dark:text-blue-200"},ze={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},Me={class:"text-center uppercase text-orange-500 dark:text-orange-200"},Ve={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},Be={class:"text-left text-teal-600 dark:text-violet-200"},Ee={class:"px-2 first:pl-7 last:pr-7 py-1 whitespace-nowrap"},Ue={class:"text-left"},Ne=["href"],je={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},Le={class:"text-center"},Oe={class:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap"},Ie={class:"flex justify-end space-x-2"},He={class:"px-2 first:pl-7 last:pr-7 py-1 whitespace-nowrap"},Fe={class:"text-center"},Je=["checked","onChange"],Ke={key:1,class:"p-5 text-center text-slate-700 dark:text-slate-100"},Ze={__name:"TagTable",props:{tags:Array,selectedTags:Array},emits:["toggle-activity","edit","delete","update-sort-order","toggle-select","toggle-all"],setup(p,{emit:v}){const{t:a}=P(),g=p,c=v,i=f([]);E(()=>g.tags,u=>{i.value=JSON.parse(JSON.stringify(u||[]))},{immediate:!0,deep:!0});const k=()=>{const u=i.value.map(x=>x.id);c("update-sort-order",u)},y=u=>{const x=u.target.checked,n=i.value.map($=>$.id);c("toggle-all",{ids:n,checked:x})};return(u,x)=>(_(),S("div",oe,[e("div",le,[p.tags.length>0?(_(),S("table",re,[e("thead",ie,[e("tr",null,[ne,e("th",ce,[e("div",de,r(l(a)("id")),1)]),e("th",ue,[e("div",{class:"flex justify-center",title:l(a)("localization")},me,8,pe)]),e("th",he,[e("div",_e,r(l(a)("name")),1)]),e("th",ge,[e("div",fe,r(l(a)("url")),1)]),e("th",xe,[e("div",{class:"flex justify-center",title:l(a)("views")},be,8,ye)]),e("th",ke,[e("div",$e,r(l(a)("actions")),1)]),e("th",Se,[e("div",Te,[e("input",{type:"checkbox",onChange:y},null,32)])])])]),m(l(K),{tag:"tbody",modelValue:i.value,"onUpdate:modelValue":x[0]||(x[0]=n=>i.value=n),onEnd:k,itemKey:"id",handle:".handle"},{item:b(({element:n})=>[e("tr",Ae,[Ce,e("td",De,[e("div",Pe,r(n.id),1)]),e("td",ze,[e("div",Me,r(n.locale),1)]),e("td",Ve,[e("div",Be,r(n.name),1)]),e("td",Ee,[e("div",Ue,[e("a",{href:`/tags/${encodeURIComponent(n.slug)}`,class:"text-violet-600 dark:text-violet-200 hover:underline hover:text-violet-800 dark:hover:text-violet-50",target:"_blank",rel:"noopener noreferrer"},r(n.slug),9,Ne)])]),e("td",je,[e("div",Le,r(n.views),1)]),e("td",Oe,[e("div",Ie,[m(se,{isActive:n.activity,onToggleActivity:$=>u.$emit("toggle-activity",n),title:n.activity?l(a)("enabled"):l(a)("disabled")},null,8,["isActive","onToggleActivity","title"]),m(ae,{href:u.route("admin.tags.edit",n.id)},null,8,["href"]),m(q,{onClick:$=>u.$emit("delete",n.id)},null,8,["onClick"])])]),e("td",He,[e("div",Fe,[e("input",{type:"checkbox",checked:p.selectedTags.includes(n.id),onChange:$=>u.$emit("toggle-select",n.id)},null,40,Je)])])])]),_:1},8,["modelValue"])])):(_(),S("div",Ke,r(l(a)("noData")),1))])]))}},Ge={class:"flex flex-col sm:flex-row items-center"},Qe={class:"block mb-2 sm:mb-0 sm:mr-2 font-semibold text-sm text-slate-700 dark:text-slate-500"},Re={value:"",disabled:"",selected:""},qe={value:"selectAll"},We={value:"deselectAll"},Xe={value:"activate"},Ye={value:"deactivate"},et={value:"delete"},tt={__name:"BulkActionSelect",props:{handleBulkAction:Function},emits:["change"],setup(p,{emit:v}){const{t:a}=P();return(g,c)=>(_(),S("div",Ge,[e("label",Qe,r(l(a)("bulkActions")),1),e("select",{class:"w-auto px-3 py-0.5 form-select bg-white dark:bg-gray-200 text-gray-600 dark:text-gray-900 border border-slate-400 dark:border-slate-600 rounded-sm shadow-sm",onChange:c[0]||(c[0]=i=>g.$emit("change",i))},[e("option",Re,r(l(a)("selectAction")),1),e("option",qe,r(l(a)("selectAll")),1),e("option",We,r(l(a)("deselectAll")),1),e("option",Xe,r(l(a)("activate")),1),e("option",Ye,r(l(a)("deactivate")),1),e("option",et,r(l(a)("deleteSelected")),1)],32)]))}},st={class:"flex justify-center items-center h-fit sm:mr-4 mt-2 mb-2"},at={for:"sortParam",class:"hidden lg:block sm:mr-2 tracking-wider text-sm font-semibold text-slate-600 dark:text-slate-100"},ot=["value"],lt={value:"idDesc"},rt={value:"idAsc"},it={value:"sort"},nt={value:"name"},ct={value:"locale"},dt={value:"views"},ut={value:"activity"},pt={value:"inactive"},vt={__name:"SortSelect",props:{sortParam:String},emits:["update:sortParam"],setup(p,{emit:v}){const{t:a}=P(),g=v,c=i=>{g("update:sortParam",i.target.value)};return(i,k)=>(_(),S("div",st,[e("label",at,r(l(a)("sort")),1),e("select",{id:"sortParam",value:p.sortParam,onChange:c,class:"w-36 px-3 py-0.5 form-select bg-white dark:bg-gray-200 text-gray-600 dark:text-gray-900 border border-slate-400 dark:border-slate-600 rounded-sm shadow-sm"},[e("option",lt,r(l(a)("idDesc")),1),e("option",rt,r(l(a)("idAsc")),1),e("option",it,r(l(a)("sortNumber")),1),e("option",nt,r(l(a)("name")),1),e("option",ct,r(l(a)("localization")),1),e("option",dt,r(l(a)("views")),1),e("option",ut,r(l(a)("active")),1),e("option",pt,r(l(a)("inactive")),1)],40,ot)]))}},mt={class:"px-4 sm:px-6 lg:px-8 py-8 w-full max-w-12xl mx-auto"},ht={class:"p-4 bg-slate-50 dark:bg-slate-700 border border-blue-400 dark:border-blue-200 overflow-hidden shadow-lg shadow-gray-500 dark:shadow-slate-400 bg-opacity-95 dark:bg-opacity-95"},_t={class:"sm:flex sm:justify-between sm:items-center mb-2"},gt=e("svg",{class:"w-4 h-4 fill-current opacity-50 shrink-0",viewBox:"0 0 16 16"},[e("path",{d:"M15 7H9V1c0-.6-.4-1-1-1S7 .4 7 1v6H1c-.6 0-1 .4-1 1s.4 1 1 1h6v6c0 .6.4 1 1 1s1-.4 1-1V9h6c.6 0 1-.4 1-1s-.4-1-1-1z"})],-1),ft={key:2,class:"flex justify-between items-center flex-col md:flex-row my-1"},Et={__name:"Index",props:["tags","tagsCount","adminCountTags","adminSortTags"],setup(p){const{t:v}=P(),a=Z(),g=p,c=f(g.adminCountTags);E(c,s=>{w.put(route("admin.settings.updateAdminCountTags"),{value:s},{preserveScroll:!0,preserveState:!0,onSuccess:()=>a.info(`Показ ${s} элементов на странице.`),onError:t=>a.error(t.value||"Ошибка обновления кол-ва элементов.")})});const i=f(g.adminSortTags);E(i,s=>{w.put(route("admin.settings.updateAdminSortTags"),{value:s},{preserveScroll:!0,preserveState:!0,onSuccess:()=>a.info("Сортировка успешно изменена"),onError:t=>a.error(t.value||"Ошибка обновления сортировки.")})});const k=f(!1),y=f(null),u=f(""),x=(s,t)=>{y.value=s,u.value=t,k.value=!0},n=()=>{k.value=!1,y.value=null,u.value=""},$=()=>{if(y.value===null)return;const s=y.value,t=u.value;w.delete(route("admin.tags.destroy",{tag:s}),{preserveScroll:!0,preserveState:!1,onSuccess:o=>{n(),a.success(`Тег "${t||"ID: "+s}" удален.`)},onError:o=>{n();const h=o.general||o[Object.keys(o)[0]]||"Произошла ошибка при удалении.";a.error(`${h} (Тег: ${t||"ID: "+s})`),console.error("Ошибка удаления:",o)},onFinish:()=>{y.value=null,u.value=""}})},N=s=>{const t=!s.activity,o=t?"активирован":"деактивирован";w.put(route("admin.actions.tags.updateActivity",{tag:s.id}),{activity:t},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{a.success(`Тег "${s.name}" ${o}.`)},onError:h=>{a.error(h.activity||h.general||`Ошибка изменения активности для "${s.name}".`)}})},T=f(1),A=f(""),j=s=>i.value==="idAsc"?s.slice().sort((t,o)=>t.id-o.id):i.value==="idDesc"?s.slice().sort((t,o)=>o.id-t.id):i.value==="activity"?s.filter(t=>t.activity):i.value==="inactive"?s.filter(t=>!t.activity):i.value==="locale"?s.slice().sort((t,o)=>t.locale<o.locale?1:t.locale>o.locale?-1:0):i.value==="views"?s.slice().sort((t,o)=>o[i.value]-t[i.value]):s.slice().sort((t,o)=>t[i.value]<o[i.value]?-1:t[i.value]>o[i.value]?1:0),z=V(()=>{let s=g.tags;return A.value&&(s=s.filter(t=>t.name.toLowerCase().includes(A.value.toLowerCase()))),j(s)}),M=V(()=>{const s=(T.value-1)*c.value;return z.value.slice(s,s+c.value)});V(()=>Math.ceil(z.value.length/c.value));const L=s=>{const t=(T.value-1)*c.value,o=s.map((h,J)=>({id:h,sort:t+J+1}));w.put(route("admin.actions.tags.updateSortBulk"),{tags:o},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{a.success("Порядок тегов успешно обновлен.")},onError:h=>{console.error("Ошибка обновления сортировки:",h),a.error(h.general||h.tags||"Не удалось обновить порядок тегов."),w.reload({only:["tags"],preserveScroll:!0})}})},d=f([]),O=({ids:s,checked:t})=>{t?d.value=[...new Set([...d.value,...s])]:d.value=d.value.filter(o=>!s.includes(o))},I=s=>{const t=d.value.indexOf(s);t>-1?d.value.splice(t,1):d.value.push(s)},U=s=>{if(!d.value.length){a.warning("Выберите теги для активации/деактивации тегов");return}axios.put(route("admin.actions.tags.bulkUpdateActivity"),{ids:d.value,activity:s}).then(()=>{a.success("Активность массово обновлена");const t=[...d.value];d.value=[],M.value.forEach(o=>{t.includes(o.id)&&(o.activity=s)})}).catch(()=>{a.error("Не удалось обновить активность")})},H=()=>{if(d.value.length===0){a.warning("Выберите хотя бы один тег для удаления.");return}confirm("Вы уверены, что хотите их удалить ?")&&w.delete(route("admin.actions.tags.bulkDestroy"),{data:{ids:d.value},preserveScroll:!0,preserveState:!1,onSuccess:s=>{d.value=[],a.success("Массовое удаление тегов успешно завершено.")},onError:s=>{console.error("Ошибка массового удаления:",s);const t=Object.keys(s)[0],o=s[t]||"Произошла ошибка при удалении тегов.";a.error(o)}})},F=s=>{const t=s.target.value;t==="selectAll"?d.value=M.value.map(o=>o.id):t==="deselectAll"?d.value=[]:t==="activate"?U(!0):t==="deactivate"?U(!1):t==="delete"&&H(),s.target.value=""};return(s,t)=>(_(),C(G,{title:l(v)("tags")},{header:b(()=>[m(Q,null,{default:b(()=>[B(r(l(v)("tags")),1)]),_:1})]),default:b(()=>[e("div",mt,[e("div",ht,[e("div",_t,[m(R,{href:s.route("admin.tags.create")},{icon:b(()=>[gt]),default:b(()=>[B(" "+r(l(v)("addTag")),1)]),_:1},8,["href"]),p.tagsCount?(_(),C(tt,{key:0,onChange:F})):D("",!0)]),p.tagsCount?(_(),C(Y,{key:0,modelValue:A.value,"onUpdate:modelValue":t[0]||(t[0]=o=>A.value=o),placeholder:l(v)("searchByName")},null,8,["modelValue","placeholder"])):D("",!0),p.tagsCount?(_(),C(W,{key:1},{default:b(()=>[B(r(p.tagsCount),1)]),_:1})):D("",!0),m(Ze,{tags:M.value,"selected-tags":d.value,onToggleActivity:N,onUpdateSortOrder:L,onDelete:x,onToggleSelect:I,onToggleAll:O},null,8,["tags","selected-tags"]),p.tagsCount?(_(),S("div",ft,[m(ee,{"items-per-page":c.value,"onUpdate:itemsPerPage":t[1]||(t[1]=o=>c.value=o)},null,8,["items-per-page"]),m(te,{"current-page":T.value,"items-per-page":c.value,"total-items":z.value.length,"onUpdate:currentPage":t[2]||(t[2]=o=>T.value=o),"onUpdate:itemsPerPage":t[3]||(t[3]=o=>c.value=o)},null,8,["current-page","items-per-page","total-items"]),m(vt,{sortParam:i.value,"onUpdate:sortParam":t[4]||(t[4]=o=>i.value=o)},null,8,["sortParam"])])):D("",!0)])]),m(X,{show:k.value,onClose:n,onCancel:n,onConfirm:$,cancelText:l(v)("cancel"),confirmText:l(v)("yesDelete")},null,8,["show","cancelText","confirmText"])]),_:1},8,["title"]))}};export{Et as default};
